0001   0000                 device zxspectrum48 ; It has nothing to do with ZX Spectrum 48K, it is needed for the sjasmplus compiler.
0002   0000                 org 100h
0003   0100             __begin: 
0004   0100             __entry: 
0005   0100             main: 
0006   0100 11 BE 0F            ld   de, __bss
0007   0103 AF                  xor  a
0008   0104             __init_loop: 
0009   0104 12                  ld   (de), a
0010   0105 13                  inc  de
0011   0106 21 E6 EF            ld   hl, 10000h - __end
0012   0109 19                  add  hl, de
0013   010A D2 04 01            jp   nc, __init_loop
0014   010D             
0015   010D             ; 309  main(int argc, char *argv[]) {
0016   010D 22 18 10    	ld (__a_2_main), hl
0017   0110             
0018   0110 31 00 90    		ld sp, 9000h
0019   0113 21 00 00    		ld hl, 0
0020   0116 E5          		push hl
0021   0117                 
0022   0117             ; 310     asm {
0023   0117             ; 311 		ld sp, 9000h
0024   0117             ; 312 		ld hl, 0
0025   0117             ; 313 		push hl
0026   0117             ; 314     }
0027   0117             ; 315 
0028   0117             ; 316     char c;
0029   0117             ; 317     bool success;
0030   0117             ; 318 
0031   0117             ; 319     // TODO: if (argc == 2 && strcmp(argv[1],"test")==0) {
0032   0117             ; 320     // TODO: 	return test();
0033   0117             ; 321     // TODO: }
0034   0117             ; 322 
0035   0117             ; 323     initBoard();
0036   0117 CD 49 02    	call initboard
0037   011A             l_0: 
0038   011A             ; 324     while (true) {
0039   011A             ; 325         c = getchar();
0040   011A CD A2 02    	call getchar
0041   011D 7D          	ld a, l
0042   011E 32 14 10    	ld (__s_main + 0), a
0043   0121             ; 326         if (c == 27) {
0044   0121 FE 1B       	cp 27
0045   0123 C2 6D 01    	jp nz, l_2
0046   0126             ; 327             c = getchar();
0047   0126 CD A2 02    	call getchar
0048   0129 7D          	ld a, l
0049   012A 32 14 10    	ld (__s_main + 0), a
0050   012D             ; 328             if (c == '[') {
0051   012D FE 5B       	cp 91
0052   012F C2 6D 01    	jp nz, l_4
0053   0132             ; 329                 c = getchar();
0054   0132 CD A2 02    	call getchar
0055   0135 7D          	ld a, l
0056   0136 32 14 10    	ld (__s_main + 0), a
0057   0139             ; 330                 switch (c) {
0058   0139 D6 41       	sub 65
0059   013B CA 4D 01    	jp z, l_10
0060   013E 3D          	dec a
0061   013F CA 55 01    	jp z, l_9
0062   0142 3D          	dec a
0063   0143 CA 65 01    	jp z, l_7
0064   0146 3D          	dec a
0065   0147 CA 5D 01    	jp z, l_8
0066   014A C3 1A 01    	jp l_0
0067   014D             l_10: 
0068   014D             ; 331                     case 'A':
0069   014D             ; 332                         c = 'W';
0070   014D 3E 57       	ld a, 87
0071   014F 32 14 10    	ld (__s_main + 0), a
0072   0152 C3 6D 01    	jp l_6
0073   0155             l_9: 
0074   0155             ; 333                         break;
0075   0155             ; 334                     case 'B':
0076   0155             ; 335                         c = 'S';
0077   0155 3E 53       	ld a, 83
0078   0157 32 14 10    	ld (__s_main + 0), a
0079   015A C3 6D 01    	jp l_6
0080   015D             l_8: 
0081   015D             ; 336                         break;
0082   015D             ; 337                     case 'D':
0083   015D             ; 338                         c = 'A';
0084   015D 3E 41       	ld a, 65
0085   015F 32 14 10    	ld (__s_main + 0), a
0086   0162 C3 6D 01    	jp l_6
0087   0165             l_7: 
0088   0165             ; 339                         break;
0089   0165             ; 340                     case 'C':
0090   0165             ; 341                         c = 'D';
0091   0165 3E 44       	ld a, 68
0092   0167 32 14 10    	ld (__s_main + 0), a
0093   016A C3 6D 01    	jp l_6
0094   016D             l_6: 
0095   016D             l_4: 
0096   016D             l_2: 
0097   016D             ; 342                         break;
0098   016D             ; 343                     default:
0099   016D             ; 344                         continue;
0100   016D             ; 345                 }
0101   016D             ; 346             }
0102   016D             ; 347         }
0103   016D             ; 348         switch (c) {
0104   016D D6 41       	sub 65
0105   016F CA 98 01    	jp z, l_19
0106   0172 D6 03       	sub 3
0107   0174 CA A1 01    	jp z, l_17
0108   0177 D6 0F       	sub 15
0109   0179 CA B3 01    	jp z, l_13
0110   017C D6 04       	sub 4
0111   017E CA AA 01    	jp z, l_15
0112   0181 D6 0A       	sub 10
0113   0183 CA 98 01    	jp z, l_20
0114   0186 D6 03       	sub 3
0115   0188 CA A1 01    	jp z, l_18
0116   018B D6 0F       	sub 15
0117   018D CA B3 01    	jp z, l_14
0118   0190 D6 04       	sub 4
0119   0192 CA AA 01    	jp z, l_16
0120   0195 C3 BC 01    	jp l_21
0121   0198             l_20: 
0122   0198             l_19: 
0123   0198             ; 349             case 'a':
0124   0198             ; 350             case 'A':
0125   0198             ; 351                 success = moveLeft();
0126   0198 CD A9 02    	call moveleft
0127   019B 32 15 10    	ld (__s_main + 1), a
0128   019E C3 C0 01    	jp l_12
0129   01A1             l_18: 
0130   01A1             l_17: 
0131   01A1             ; 352                 break;
0132   01A1             ; 353             case 'd':
0133   01A1             ; 354             case 'D':
0134   01A1             ; 355                 success = moveRight();
0135   01A1 CD BF 02    	call moveright
0136   01A4 32 15 10    	ld (__s_main + 1), a
0137   01A7 C3 C0 01    	jp l_12
0138   01AA             l_16: 
0139   01AA             l_15: 
0140   01AA             ; 356                 break;
0141   01AA             ; 357             case 'w':
0142   01AA             ; 358             case 'W':
0143   01AA             ; 359                 success = moveUp();
0144   01AA CD D5 02    	call moveup
0145   01AD 32 15 10    	ld (__s_main + 1), a
0146   01B0 C3 C0 01    	jp l_12
0147   01B3             l_14: 
0148   01B3             l_13: 
0149   01B3             ; 360                 break;
0150   01B3             ; 361             case 's':
0151   01B3             ; 362             case 'S':
0152   01B3             ; 363                 success = moveDown();
0153   01B3 CD 07 03    	call movedown
0154   01B6 32 15 10    	ld (__s_main + 1), a
0155   01B9 C3 C0 01    	jp l_12
0156   01BC             l_21: 
0157   01BC             ; 364                 break;
0158   01BC             ; 365             default:
0159   01BC             ; 366                 success = false;
0160   01BC             ; 24 ;
0161   01BC AF          	xor a
0162   01BD 32 15 10    	ld (__s_main + 1), a
0163   01C0             l_12: 
0164   01C0             ; 368 ) {
0165   01C0 B7          	or a
0166   01C1 CA E5 01    	jp z, l_22
0167   01C4             ; 369             drawBoard();
0168   01C4 CD 1D 03    	call drawboard
0169   01C7             ; 370             sleep(2);
0170   01C7 21 02 00    	ld hl, 2
0171   01CA CD 0F 04    	call sleep
0172   01CD             ; 371             addRandom();
0173   01CD CD 2B 04    	call addrandom
0174   01D0             ; 372             drawBoard();
0175   01D0 CD 1D 03    	call drawboard
0176   01D3             ; 373             if (gameEnded()) {
0177   01D3 CD FF 04    	call gameended
0178   01D6 B7          	or a
0179   01D7 CA E5 01    	jp z, l_24
0180   01DA             ; 374                 printf("            GAME OVER          \n");
0181   01DA 21 0C 0F    	ld hl, __c_18
0182   01DD E5          	push hl
0183   01DE CD 31 05    	call printf
0184   01E1 C1          	pop bc
0185   01E2 C3 3D 02    	jp l_1
0186   01E5             l_24: 
0187   01E5             l_22: 
0188   01E5             ; 375                 break;
0189   01E5             ; 376             }
0190   01E5             ; 377         }
0191   01E5             ; 378         if (c == 'q' || c == 'Q') {
0192   01E5 3A 14 10    	ld a, (__s_main + 0)
0193   01E8 FE 71       	cp 113
0194   01EA CA F2 01    	jp z, l_28
0195   01ED FE 51       	cp 81
0196   01EF C2 0E 02    	jp nz, l_26
0197   01F2             l_28: 
0198   01F2             ; 379             printf("            QUIT? (y/n)         \n");
0199   01F2 21 2D 0F    	ld hl, __c_19
0200   01F5 E5          	push hl
0201   01F6 CD 31 05    	call printf
0202   01F9 C1          	pop bc
0203   01FA             ; 380             c = getchar();
0204   01FA CD A2 02    	call getchar
0205   01FD 7D          	ld a, l
0206   01FE 32 14 10    	ld (__s_main + 0), a
0207   0201             ; 381             if (c == 'y' || c == 'Y') {
0208   0201 FE 79       	cp 121
0209   0203 CA 3D 02    	jp z, l_1
0210   0206 FE 59       	cp 89
0211   0208 CA 3D 02    	jp z, l_1
0212   020B             ; 382                 break;
0213   020B             ; 383             }
0214   020B             ; 384             prepareScreen();
0215   020B CD 5F 05    	call preparescreen
0216   020E             l_26: 
0217   020E             ; 385         }
0218   020E             ; 386         if (c == 'r' || c == 'R') {
0219   020E 3A 14 10    	ld a, (__s_main + 0)
0220   0211 FE 72       	cp 114
0221   0213 CA 1B 02    	jp z, l_34
0222   0216 FE 52       	cp 82
0223   0218 C2 1A 01    	jp nz, l_0
0224   021B             l_34: 
0225   021B             ; 387             printf("          RESTART? (y/n)       \n");
0226   021B 21 4F 0F    	ld hl, __c_20
0227   021E E5          	push hl
0228   021F CD 31 05    	call printf
0229   0222 C1          	pop bc
0230   0223             ; 388             c = getchar();
0231   0223 CD A2 02    	call getchar
0232   0226 7D          	ld a, l
0233   0227 32 14 10    	ld (__s_main + 0), a
0234   022A             ; 389             if (c == 'y' || c == 'Y') {
0235   022A FE 79       	cp 121
0236   022C CA 34 02    	jp z, l_37
0237   022F FE 59       	cp 89
0238   0231 C2 37 02    	jp nz, l_35
0239   0234             l_37: 
0240   0234             ; 390                 initBoard();
0241   0234 CD 49 02    	call initboard
0242   0237             l_35: 
0243   0237             ; 391             }
0244   0237             ; 392             prepareScreen();
0245   0237 CD 5F 05    	call preparescreen
0246   023A C3 1A 01    	jp l_0
0247   023D             l_1: 
0248   023D             ; 393         }
0249   023D             ; 394     }
0250   023D             ; 395 
0251   023D             ; 396     printf(ESC_CLEAR_SCREEN);
0252   023D 21 04 0F    	ld hl, __c_7
0253   0240 E5          	push hl
0254   0241 CD 31 05    	call printf
0255   0244 C1          	pop bc
0256   0245             ; 397 
0257   0245             ; 398     return EXIT_SUCCESS;
0258   0245 21 00 00    	ld hl, 0
0259   0248 C9          	ret
0260   0249             initboard: 
0261   0249             ; 244  initBoard() {
0262   0249             ; 245     uint8_t x, y;
0263   0249             ; 246     for (x = 0; x < SIZE; x++) {
0264   0249 AF          	xor a
0265   024A 32 12 10    	ld (__s_initboard + 0), a
0266   024D             l_38: 
0267   024D 3A 12 10    	ld a, (__s_initboard + 0)
0268   0250 FE 04       	cp 4
0269   0252 D2 89 02    	jp nc, l_40
0270   0255             ; 247         for (y = 0; y < SIZE; y++) {
0271   0255 AF          	xor a
0272   0256 32 13 10    	ld (__s_initboard + 1), a
0273   0259             l_41: 
0274   0259 3A 13 10    	ld a, (__s_initboard + 1)
0275   025C FE 04       	cp 4
0276   025E D2 7F 02    	jp nc, l_43
0277   0261             ; 248             board[x][y] = 0;
0278   0261 2A 12 10    	ld hl, (__s_initboard + 0)
0279   0264 26 00       	ld h, 0
0280   0266 29          	add hl, hl
0281   0267 29          	add hl, hl
0282   0268 11 BE 0F    	ld de, board
0283   026B 19          	add hl, de
0284   026C EB          	ex hl, de
0285   026D 2A 13 10    	ld hl, (__s_initboard + 1)
0286   0270 26 00       	ld h, 0
0287   0272 19          	add hl, de
0288   0273 36 00       	ld (hl), 0
0289   0275             l_42: 
0290   0275 3A 13 10    	ld a, (__s_initboard + 1)
0291   0278 3C          	inc a
0292   0279 32 13 10    	ld (__s_initboard + 1), a
0293   027C C3 59 02    	jp l_41
0294   027F             l_43: 
0295   027F             l_39: 
0296   027F 3A 12 10    	ld a, (__s_initboard + 0)
0297   0282 3C          	inc a
0298   0283 32 12 10    	ld (__s_initboard + 0), a
0299   0286 C3 4D 02    	jp l_38
0300   0289             l_40: 
0301   0289             ; 249         }
0302   0289             ; 250     }
0303   0289             ; 251     addRandom();
0304   0289 CD 2B 04    	call addrandom
0305   028C             ; 252     addRandom();
0306   028C CD 2B 04    	call addrandom
0307   028F             ; 253     prepareScreen();
0308   028F CD 5F 05    	call preparescreen
0309   0292             ; 254     score = 0;
0310   0292 11 00 00    	ld de, 0
0311   0295 21 00 00    	ld hl, 0
0312   0298 22 B7 0F    	ld (score), hl
0313   029B EB          	ex hl, de
0314   029C 22 B9 0F    	ld ((score) + 2), hl
0315   029F             ; 255     drawBoard();
0316   029F C3 1D 03    	jp drawboard
0317   02A2             getchar: 
0318   02A2             ; 40  getchar() {
0319   02A2             ; 41     return cpmBiosConIn();
0320   02A2 CD 23 06    	call cpmbiosconin
0321   02A5 6F          	ld l, a
0322   02A6 26 00       	ld h, 0
0323   02A8 C9          	ret
0324   02A9             moveleft: 
0325   02A9             ; 144  moveLeft() {
0326   02A9             ; 145     bool success;
0327   02A9             ; 146     rotateBoard();
0328   02A9 CD 2A 06    	call rotateboard
0329   02AC             ; 147     success = moveUp();
0330   02AC CD D5 02    	call moveup
0331   02AF 32 E1 0F    	ld (__s_moveleft + 0), a
0332   02B2             ; 148     rotateBoard();
0333   02B2 CD 2A 06    	call rotateboard
0334   02B5             ; 149     rotateBoard();
0335   02B5 CD 2A 06    	call rotateboard
0336   02B8             ; 150     rotateBoard();
0337   02B8 CD 2A 06    	call rotateboard
0338   02BB             ; 151     return success;
0339   02BB 3A E1 0F    	ld a, (__s_moveleft + 0)
0340   02BE C9          	ret
0341   02BF             moveright: 
0342   02BF             ; 164  moveRight() {
0343   02BF             ; 165     bool success;
0344   02BF             ; 166     rotateBoard();
0345   02BF CD 2A 06    	call rotateboard
0346   02C2             ; 167     rotateBoard();
0347   02C2 CD 2A 06    	call rotateboard
0348   02C5             ; 168     rotateBoard();
0349   02C5 CD 2A 06    	call rotateboard
0350   02C8             ; 169     success = moveUp();
0351   02C8 CD D5 02    	call moveup
0352   02CB 32 E1 0F    	ld (__s_moveright + 0), a
0353   02CE             ; 170     rotateBoard();
0354   02CE CD 2A 06    	call rotateboard
0355   02D1             ; 171     return success;
0356   02D1 3A E1 0F    	ld a, (__s_moveright + 0)
0357   02D4 C9          	ret
0358   02D5             moveup: 
0359   02D5             ; 135  moveUp() {
0360   02D5             ; 136     bool success = false;
0361   02D5             ; 24 ;
0362   02D5 AF          	xor a
0363   02D6 32 DF 0F    	ld (__s_moveup + 0), a
0364   02D9             ; 138  = 0; x < SIZE; x++) {
0365   02D9 32 E0 0F    	ld (__s_moveup + 1), a
0366   02DC             l_44: 
0367   02DC 3A E0 0F    	ld a, (__s_moveup + 1)
0368   02DF FE 04       	cp 4
0369   02E1 D2 03 03    	jp nc, l_46
0370   02E4             ; 139         success |= slideArray(board[x]);
0371   02E4 2A E0 0F    	ld hl, (__s_moveup + 1)
0372   02E7 26 00       	ld h, 0
0373   02E9 29          	add hl, hl
0374   02EA 29          	add hl, hl
0375   02EB 11 BE 0F    	ld de, board
0376   02EE 19          	add hl, de
0377   02EF CD 73 07    	call slidearray
0378   02F2 21 DF 0F    	ld hl, __s_moveup + 0
0379   02F5 B6          	or (hl)
0380   02F6 32 DF 0F    	ld (__s_moveup + 0), a
0381   02F9             l_45: 
0382   02F9 3A E0 0F    	ld a, (__s_moveup + 1)
0383   02FC 3C          	inc a
0384   02FD 32 E0 0F    	ld (__s_moveup + 1), a
0385   0300 C3 DC 02    	jp l_44
0386   0303             l_46: 
0387   0303             ; 140     }
0388   0303             ; 141     return success;
0389   0303 3A DF 0F    	ld a, (__s_moveup + 0)
0390   0306 C9          	ret
0391   0307             movedown: 
0392   0307             ; 154  moveDown() {
0393   0307             ; 155     bool success;
0394   0307             ; 156     rotateBoard();
0395   0307 CD 2A 06    	call rotateboard
0396   030A             ; 157     rotateBoard();
0397   030A CD 2A 06    	call rotateboard
0398   030D             ; 158     success = moveUp();
0399   030D CD D5 02    	call moveup
0400   0310 32 E1 0F    	ld (__s_movedown + 0), a
0401   0313             ; 159     rotateBoard();
0402   0313 CD 2A 06    	call rotateboard
0403   0316             ; 160     rotateBoard();
0404   0316 CD 2A 06    	call rotateboard
0405   0319             ; 161     return success;
0406   0319 3A E1 0F    	ld a, (__s_movedown + 0)
0407   031C C9          	ret
0408   031D             drawboard: 
0409   031D             ; 25  drawBoard() {
0410   031D             ; 26     uint8_t x, y;
0411   031D             ; 27     uint8_t t;
0412   031D             ; 28     printf(ESC_HOME_CURSOR);
0413   031D 21 00 0F    	ld hl, __c_0
0414   0320 E5          	push hl
0415   0321 CD 31 05    	call printf
0416   0324 C1          	pop bc
0417   0325             ; 29 
0418   0325             ; 30     printf("2048.c %23d pts", score);
0419   0325 2A B9 0F    	ld hl, (((score) + 2))
0420   0328 EB          	ex hl, de
0421   0329 2A B7 0F    	ld hl, (score)
0422   032C D5          	push de
0423   032D E5          	push hl
0424   032E 21 91 0F    	ld hl, __c_1
0425   0331 E5          	push hl
0426   0332 CD 31 05    	call printf
0427   0335 C1          	pop bc
0428   0336 C1          	pop bc
0429   0337 C1          	pop bc
0430   0338             ; 31     for (y = 0; y < SIZE; y++) {
0431   0338 AF          	xor a
0432   0339 32 05 10    	ld (__s_drawboard + 1), a
0433   033C             l_47: 
0434   033C 3A 05 10    	ld a, (__s_drawboard + 1)
0435   033F FE 04       	cp 4
0436   0341 D2 06 04    	jp nc, l_49
0437   0344             ; 32         printf("\n\n\n\n");
0438   0344 21 D9 0E    	ld hl, __c_2
0439   0347 E5          	push hl
0440   0348 CD 31 05    	call printf
0441   034B C1          	pop bc
0442   034C             ; 33         for (x = 0; x < SIZE; x++) {
0443   034C AF          	xor a
0444   034D 32 04 10    	ld (__s_drawboard + 0), a
0445   0350             l_50: 
0446   0350 3A 04 10    	ld a, (__s_drawboard + 0)
0447   0353 FE 04       	cp 4
0448   0355 D2 FC 03    	jp nc, l_52
0449   0358             ; 34             if (board[x][y] != 0) {
0450   0358 2A 04 10    	ld hl, (__s_drawboard + 0)
0451   035B 26 00       	ld h, 0
0452   035D 29          	add hl, hl
0453   035E 29          	add hl, hl
0454   035F 11 BE 0F    	ld de, board
0455   0362 19          	add hl, de
0456   0363 EB          	ex hl, de
0457   0364 2A 05 10    	ld hl, (__s_drawboard + 1)
0458   0367 26 00       	ld h, 0
0459   0369 19          	add hl, de
0460   036A 7E          	ld a, (hl)
0461   036B B7          	or a
0462   036C CA EA 03    	jp z, l_53
0463   036F             ; 35                 char s[8];
0464   036F             ; 36                 snprintf(s, 8, "%u", 1 << board[x][y]);
0465   036F 2A 04 10    	ld hl, (__s_drawboard + 0)
0466   0372 26 00       	ld h, 0
0467   0374 29          	add hl, hl
0468   0375 29          	add hl, hl
0469   0376 11 BE 0F    	ld de, board
0470   0379 19          	add hl, de
0471   037A EB          	ex hl, de
0472   037B 2A 05 10    	ld hl, (__s_drawboard + 1)
0473   037E 26 00       	ld h, 0
0474   0380 19          	add hl, de
0475   0381 6E          	ld l, (hl)
0476   0382 26 00       	ld h, 0
0477   0384 11 01 00    	ld de, 1
0478   0387 EB          	ex hl, de
0479   0388 CD BD 0D    	call __o_shl_16
0480   038B E5          	push hl
0481   038C 21 70 0F    	ld hl, __c_3
0482   038F E5          	push hl
0483   0390 21 08 00    	ld hl, 8
0484   0393 E5          	push hl
0485   0394 21 07 10    	ld hl, __s_drawboard + 3
0486   0397 E5          	push hl
0487   0398 CD 57 08    	call snprintf
0488   039B 21 08 00    	ld hl, 8
0489   039E 39          	add hl, sp
0490   039F F9          	ld sp, hl
0491   03A0             ; 37                 t = 7 - strlen(s);
0492   03A0 21 07 10    	ld hl, __s_drawboard + 3
0493   03A3 CD 95 08    	call strlen
0494   03A6 7D          	ld a, l
0495   03A7 57          	ld d, a
0496   03A8 3E 07       	ld a, 7
0497   03AA 92          	sub d
0498   03AB 32 06 10    	ld (__s_drawboard + 2), a
0499   03AE             ; 38                 printf("|%*s%s%*s", t - t / 2, "", s, t / 2, "");
0500   03AE 21 D8 0E    	ld hl, __c_5
0501   03B1 E5          	push hl
0502   03B2 2A 06 10    	ld hl, (__s_drawboard + 2)
0503   03B5 26 00       	ld h, 0
0504   03B7 11 01 00    	ld de, 1
0505   03BA CD C4 0D    	call __o_shr_u16
0506   03BD E5          	push hl
0507   03BE 21 07 10    	ld hl, __s_drawboard + 3
0508   03C1 E5          	push hl
0509   03C2 21 D8 0E    	ld hl, __c_5
0510   03C5 E5          	push hl
0511   03C6 2A 06 10    	ld hl, (__s_drawboard + 2)
0512   03C9 26 00       	ld h, 0
0513   03CB 11 01 00    	ld de, 1
0514   03CE CD C4 0D    	call __o_shr_u16
0515   03D1 EB          	ex hl, de
0516   03D2 2A 06 10    	ld hl, (__s_drawboard + 2)
0517   03D5 26 00       	ld h, 0
0518   03D7 CD 6A 0D    	call __o_sub_16
0519   03DA E5          	push hl
0520   03DB 21 AD 0F    	ld hl, __c_4
0521   03DE E5          	push hl
0522   03DF CD 31 05    	call printf
0523   03E2 21 0C 00    	ld hl, 12
0524   03E5 39          	add hl, sp
0525   03E6 F9          	ld sp, hl
0526   03E7 C3 F2 03    	jp l_54
0527   03EA             l_53: 
0528   03EA             ; 39             } else {
0529   03EA             ; 40                 printf("|       ");
0530   03EA 21 A4 0F    	ld hl, __c_6
0531   03ED E5          	push hl
0532   03EE CD 31 05    	call printf
0533   03F1 C1          	pop bc
0534   03F2             l_54: 
0535   03F2             l_51: 
0536   03F2 3A 04 10    	ld a, (__s_drawboard + 0)
0537   03F5 3C          	inc a
0538   03F6 32 04 10    	ld (__s_drawboard + 0), a
0539   03F9 C3 50 03    	jp l_50
0540   03FC             l_52: 
0541   03FC             l_48: 
0542   03FC 3A 05 10    	ld a, (__s_drawboard + 1)
0543   03FF 3C          	inc a
0544   0400 32 05 10    	ld (__s_drawboard + 1), a
0545   0403 C3 3C 03    	jp l_47
0546   0406             l_49: 
0547   0406             ; 41             }
0548   0406             ; 42         }
0549   0406             ; 43     }
0550   0406             ; 44     printf("\n\n\n\n");
0551   0406 21 D9 0E    	ld hl, __c_2
0552   0409 E5          	push hl
0553   040A CD 31 05    	call printf
0554   040D C1          	pop bc
0555   040E C9          	ret
0556   040F             sleep: 
0557   040F             ; 25  sleep(unsigned seconds) {
0558   040F 22 D6 0F    	ld (__a_1_sleep), hl
0559   0412             l_55: 
0560   0412             ; 26     while (seconds != 0) {
0561   0412 2A D6 0F    	ld hl, (__a_1_sleep)
0562   0415 7C          	ld a, h
0563   0416 B5          	or l
0564   0417 CA 27 04    	jp z, l_56
0565   041A             ; 27         seconds--;
0566   041A 2B          	dec hl
0567   041B 22 D6 0F    	ld (__a_1_sleep), hl
0568   041E             ; 28         Delay(__C8080_ONE_SECOND_DELAY);
0569   041E 21 88 13    	ld hl, 5000
0570   0421 CD A4 08    	call delay
0571   0424 C3 12 04    	jp l_55
0572   0427             l_56: 
0573   0427             ; 29     }
0574   0427             ; 30     return 0;
0575   0427 21 00 00    	ld hl, 0
0576   042A C9          	ret
0577   042B             addrandom: 
0578   042B             ; 214  addRandom() {
0579   042B             ; 215     static bool initialized = false;
0580   042B             ; 216     uint8_t x, y;
0581   042B             ; 217     uint8_t r, len = 0;
0582   042B AF          	xor a
0583   042C 32 D7 0F    	ld (__s_addrandom + 3), a
0584   042F             ; 218     uint8_t n, list[SIZE * SIZE][2];
0585   042F             ; 219 
0586   042F             ; 220     if (!initialized) {
0587   042F 3A BB 0F    	ld a, (__s_addrandom_initialized)
0588   0432 B7          	or a
0589   0433 C2 3B 04    	jp nz, l_57
0590   0436             ; 221         // srand(time(NULL));
0591   0436             ; 222         initialized = true;
0592   0436             ; 25 ;
0593   0436 3E 01       	ld a, 1
0594   0438 32 BB 0F    	ld (__s_addrandom_initialized), a
0595   043B             l_57: 
0596   043B             ; 225  = 0; x < SIZE; x++) {
0597   043B AF          	xor a
0598   043C 32 D4 0F    	ld (__s_addrandom + 0), a
0599   043F             l_59: 
0600   043F 3A D4 0F    	ld a, (__s_addrandom + 0)
0601   0442 FE 04       	cp 4
0602   0444 D2 9F 04    	jp nc, l_61
0603   0447             ; 226         for (y = 0; y < SIZE; y++) {
0604   0447 AF          	xor a
0605   0448 32 D5 0F    	ld (__s_addrandom + 1), a
0606   044B             l_62: 
0607   044B 3A D5 0F    	ld a, (__s_addrandom + 1)
0608   044E FE 04       	cp 4
0609   0450 D2 95 04    	jp nc, l_64
0610   0453             ; 227             if (board[x][y] == 0) {
0611   0453 2A D4 0F    	ld hl, (__s_addrandom + 0)
0612   0456 26 00       	ld h, 0
0613   0458 29          	add hl, hl
0614   0459 29          	add hl, hl
0615   045A 11 BE 0F    	ld de, board
0616   045D 19          	add hl, de
0617   045E EB          	ex hl, de
0618   045F 2A D5 0F    	ld hl, (__s_addrandom + 1)
0619   0462 26 00       	ld h, 0
0620   0464 19          	add hl, de
0621   0465 7E          	ld a, (hl)
0622   0466 B7          	or a
0623   0467 C2 8B 04    	jp nz, l_65
0624   046A             ; 228                 list[len][0] = x;
0625   046A 3A D4 0F    	ld a, (__s_addrandom + 0)
0626   046D 2A D7 0F    	ld hl, (__s_addrandom + 3)
0627   0470 26 00       	ld h, 0
0628   0472 29          	add hl, hl
0629   0473 11 D9 0F    	ld de, __s_addrandom + 5
0630   0476 19          	add hl, de
0631   0477 77          	ld (hl), a
0632   0478             ; 229                 list[len][1] = y;
0633   0478 3A D5 0F    	ld a, (__s_addrandom + 1)
0634   047B 2A D7 0F    	ld hl, (__s_addrandom + 3)
0635   047E 26 00       	ld h, 0
0636   0480 29          	add hl, hl
0637   0481 19          	add hl, de
0638   0482 23          	inc hl
0639   0483 77          	ld (hl), a
0640   0484             ; 230                 len++;
0641   0484 3A D7 0F    	ld a, (__s_addrandom + 3)
0642   0487 3C          	inc a
0643   0488 32 D7 0F    	ld (__s_addrandom + 3), a
0644   048B             l_65: 
0645   048B             l_63: 
0646   048B 3A D5 0F    	ld a, (__s_addrandom + 1)
0647   048E 3C          	inc a
0648   048F 32 D5 0F    	ld (__s_addrandom + 1), a
0649   0492 C3 4B 04    	jp l_62
0650   0495             l_64: 
0651   0495             l_60: 
0652   0495 3A D4 0F    	ld a, (__s_addrandom + 0)
0653   0498 3C          	inc a
0654   0499 32 D4 0F    	ld (__s_addrandom + 0), a
0655   049C C3 3F 04    	jp l_59
0656   049F             l_61: 
0657   049F             ; 231             }
0658   049F             ; 232         }
0659   049F             ; 233     }
0660   049F             ; 234 
0661   049F             ; 235     if (len > 0) {
0662   049F 3A D7 0F    	ld a, (__s_addrandom + 3)
0663   04A2 B7          	or a
0664   04A3 C8          	ret z
0665   04A4             ; 236         r = (uint8_t)rand() % len;
0666   04A4 CD B4 08    	call rand
0667   04A7 7D          	ld a, l
0668   04A8 6F          	ld l, a
0669   04A9 26 00       	ld h, 0
0670   04AB EB          	ex hl, de
0671   04AC 2A D7 0F    	ld hl, (__s_addrandom + 3)
0672   04AF 26 00       	ld h, 0
0673   04B1 EB          	ex hl, de
0674   04B2 CD B5 0D    	call __o_mod_u16
0675   04B5 7D          	ld a, l
0676   04B6 32 D6 0F    	ld (__s_addrandom + 2), a
0677   04B9             ; 237         x = list[r][0];
0678   04B9 2A D6 0F    	ld hl, (__s_addrandom + 2)
0679   04BC 26 00       	ld h, 0
0680   04BE 29          	add hl, hl
0681   04BF 11 D9 0F    	ld de, __s_addrandom + 5
0682   04C2 19          	add hl, de
0683   04C3 7E          	ld a, (hl)
0684   04C4 32 D4 0F    	ld (__s_addrandom + 0), a
0685   04C7             ; 238         y = list[r][1];
0686   04C7 2A D6 0F    	ld hl, (__s_addrandom + 2)
0687   04CA 26 00       	ld h, 0
0688   04CC 29          	add hl, hl
0689   04CD 19          	add hl, de
0690   04CE 23          	inc hl
0691   04CF 7E          	ld a, (hl)
0692   04D0 32 D5 0F    	ld (__s_addrandom + 1), a
0693   04D3             ; 239         n = ((uint8_t)rand() % 10) / 9 + 1;
0694   04D3 CD B4 08    	call rand
0695   04D6 7D          	ld a, l
0696   04D7 6F          	ld l, a
0697   04D8 26 00       	ld h, 0
0698   04DA 11 0A 00    	ld de, 10
0699   04DD CD B5 0D    	call __o_mod_u16
0700   04E0 11 09 00    	ld de, 9
0701   04E3 CD 7B 0D    	call __o_div_u16
0702   04E6 7D          	ld a, l
0703   04E7 3C          	inc a
0704   04E8 32 D8 0F    	ld (__s_addrandom + 4), a
0705   04EB             ; 240         board[x][y] = n;
0706   04EB 2A D4 0F    	ld hl, (__s_addrandom + 0)
0707   04EE 26 00       	ld h, 0
0708   04F0 29          	add hl, hl
0709   04F1 29          	add hl, hl
0710   04F2 11 BE 0F    	ld de, board
0711   04F5 19          	add hl, de
0712   04F6 EB          	ex hl, de
0713   04F7 2A D5 0F    	ld hl, (__s_addrandom + 1)
0714   04FA 26 00       	ld h, 0
0715   04FC 19          	add hl, de
0716   04FD 77          	ld (hl), a
0717   04FE C9          	ret
0718   04FF             gameended: 
0719   04FF             ; 199  gameEnded() {
0720   04FF             ; 200     bool ended = true;
0721   04FF             ; 25 ;
0722   04FF 3E 01       	ld a, 1
0723   0501 32 D8 0F    	ld (__s_gameended + 0), a
0724   0504             ; 201 ) > 0)
0725   0504 CD EB 08    	call countempty
0726   0507 B7          	or a
0727   0508 CA 0D 05    	jp z, l_69
0728   050B             ; 24 ;
0729   050B AF          	xor a
0730   050C C9          	ret
0731   050D             l_69: 
0732   050D             ; 203 ))
0733   050D CD 3C 09    	call findpairdown
0734   0510 B7          	or a
0735   0511 CA 16 05    	jp z, l_71
0736   0514             ; 24 ;
0737   0514 AF          	xor a
0738   0515 C9          	ret
0739   0516             l_71: 
0740   0516             ; 205 );
0741   0516 CD 2A 06    	call rotateboard
0742   0519             ; 206     if (findPairDown())
0743   0519 CD 3C 09    	call findpairdown
0744   051C B7          	or a
0745   051D CA 24 05    	jp z, l_73
0746   0520             ; 207         ended = false;
0747   0520             ; 24 ;
0748   0520 AF          	xor a
0749   0521 32 D8 0F    	ld (__s_gameended + 0), a
0750   0524             l_73: 
0751   0524             ; 208 );
0752   0524 CD 2A 06    	call rotateboard
0753   0527             ; 209     rotateBoard();
0754   0527 CD 2A 06    	call rotateboard
0755   052A             ; 210     rotateBoard();
0756   052A CD 2A 06    	call rotateboard
0757   052D             ; 211     return ended;
0758   052D 3A D8 0F    	ld a, (__s_gameended + 0)
0759   0530 C9          	ret
0760   0531             printf: 
0761   0531             ; 21  __stdcall printf(const char *format, ...) {
0762   0531 C5          	push bc
0763   0532             ; 22     va_list va;
0764   0532             ; 23     va_start(va, format);
0765   0532 21 06 00    	ld hl, 6
0766   0535 39          	add hl, sp
0767   0536 EB          	ex hl, de
0768   0537 21 00 00    	ld hl, 0
0769   053A 39          	add hl, sp
0770   053B 73          	ld (hl), e
0771   053C 23          	inc hl
0772   053D 72          	ld (hl), d
0773   053E             ; 24     __printf_out_pointer = NULL;
0774   053E 21 00 00    	ld hl, 0
0775   0541 22 CE 0F    	ld (__printf_out_pointer), hl
0776   0544             ; 25     __printf(format, va);
0777   0544 21 04 00    	ld hl, 4
0778   0547 39          	add hl, sp
0779   0548 5E          	ld e, (hl)
0780   0549 23          	inc hl
0781   054A 56          	ld d, (hl)
0782   054B EB          	ex hl, de
0783   054C 22 F4 0F    	ld (__a_1___printf), hl
0784   054F 21 00 00    	ld hl, 0
0785   0552 39          	add hl, sp
0786   0553 5E          	ld e, (hl)
0787   0554 23          	inc hl
0788   0555 56          	ld d, (hl)
0789   0556 EB          	ex hl, de
0790   0557 CD 9C 09    	call __printf
0791   055A             ; 26     va_end(va);
0792   055A             ; 27     return __printf_out_total;
0793   055A 2A D2 0F    	ld hl, (__printf_out_total)
0794   055D C1          	pop bc
0795   055E C9          	ret
0796   055F             preparescreen: 
0797   055F             ; 47  prepareScreen() {
0798   055F             ; 48     uint8_t x, y, i;
0799   055F             ; 49     printf(ESC_CLEAR_SCREEN);
0800   055F 21 04 0F    	ld hl, __c_7
0801   0562 E5          	push hl
0802   0563 CD 31 05    	call printf
0803   0566 C1          	pop bc
0804   0567             ; 50 
0805   0567             ; 51     printf("2048.c %17d pts\n\n", score);
0806   0567 2A B9 0F    	ld hl, (((score) + 2))
0807   056A EB          	ex hl, de
0808   056B 2A B7 0F    	ld hl, (score)
0809   056E D5          	push de
0810   056F E5          	push hl
0811   0570 21 7F 0F    	ld hl, __c_8
0812   0573 E5          	push hl
0813   0574 CD 31 05    	call printf
0814   0577 C1          	pop bc
0815   0578 C1          	pop bc
0816   0579 C1          	pop bc
0817   057A             ; 52     for (x = 0; x < SIZE; x++)
0818   057A AF          	xor a
0819   057B 32 0F 10    	ld (__s_preparescreen + 0), a
0820   057E             l_76: 
0821   057E 3A 0F 10    	ld a, (__s_preparescreen + 0)
0822   0581 FE 04       	cp 4
0823   0583 D2 98 05    	jp nc, l_78
0824   0586             ; 53         printf("+-------");
0825   0586 21 76 0F    	ld hl, __c_9
0826   0589 E5          	push hl
0827   058A CD 31 05    	call printf
0828   058D C1          	pop bc
0829   058E             l_77: 
0830   058E 3A 0F 10    	ld a, (__s_preparescreen + 0)
0831   0591 3C          	inc a
0832   0592 32 0F 10    	ld (__s_preparescreen + 0), a
0833   0595 C3 7E 05    	jp l_76
0834   0598             l_78: 
0835   0598             ; 54     printf("+\n");
0836   0598 21 73 0F    	ld hl, __c_10
0837   059B E5          	push hl
0838   059C CD 31 05    	call printf
0839   059F C1          	pop bc
0840   05A0             ; 55     for (y = 0; y < SIZE; y++) {
0841   05A0 AF          	xor a
0842   05A1 32 10 10    	ld (__s_preparescreen + 1), a
0843   05A4             l_79: 
0844   05A4 3A 10 10    	ld a, (__s_preparescreen + 1)
0845   05A7 FE 04       	cp 4
0846   05A9 D2 18 06    	jp nc, l_81
0847   05AC             ; 56         for (i = 0; i < 3; i++) {
0848   05AC AF          	xor a
0849   05AD 32 11 10    	ld (__s_preparescreen + 2), a
0850   05B0             l_82: 
0851   05B0 3A 11 10    	ld a, (__s_preparescreen + 2)
0852   05B3 FE 03       	cp 3
0853   05B5 D2 E8 05    	jp nc, l_84
0854   05B8             ; 57             for (x = 0; x < SIZE; x++)
0855   05B8 AF          	xor a
0856   05B9 32 0F 10    	ld (__s_preparescreen + 0), a
0857   05BC             l_85: 
0858   05BC 3A 0F 10    	ld a, (__s_preparescreen + 0)
0859   05BF FE 04       	cp 4
0860   05C1 D2 D6 05    	jp nc, l_87
0861   05C4             ; 58                 printf("|       ");
0862   05C4 21 A4 0F    	ld hl, __c_6
0863   05C7 E5          	push hl
0864   05C8 CD 31 05    	call printf
0865   05CB C1          	pop bc
0866   05CC             l_86: 
0867   05CC 3A 0F 10    	ld a, (__s_preparescreen + 0)
0868   05CF 3C          	inc a
0869   05D0 32 0F 10    	ld (__s_preparescreen + 0), a
0870   05D3 C3 BC 05    	jp l_85
0871   05D6             l_87: 
0872   05D6             ; 59             printf("|\n");
0873   05D6 21 A1 0F    	ld hl, __c_11
0874   05D9 E5          	push hl
0875   05DA CD 31 05    	call printf
0876   05DD C1          	pop bc
0877   05DE             l_83: 
0878   05DE 3A 11 10    	ld a, (__s_preparescreen + 2)
0879   05E1 3C          	inc a
0880   05E2 32 11 10    	ld (__s_preparescreen + 2), a
0881   05E5 C3 B0 05    	jp l_82
0882   05E8             l_84: 
0883   05E8             ; 60         }
0884   05E8             ; 61         for (x = 0; x < SIZE; x++)
0885   05E8 AF          	xor a
0886   05E9 32 0F 10    	ld (__s_preparescreen + 0), a
0887   05EC             l_88: 
0888   05EC 3A 0F 10    	ld a, (__s_preparescreen + 0)
0889   05EF FE 04       	cp 4
0890   05F1 D2 06 06    	jp nc, l_90
0891   05F4             ; 62             printf("+-------");
0892   05F4 21 76 0F    	ld hl, __c_9
0893   05F7 E5          	push hl
0894   05F8 CD 31 05    	call printf
0895   05FB C1          	pop bc
0896   05FC             l_89: 
0897   05FC 3A 0F 10    	ld a, (__s_preparescreen + 0)
0898   05FF 3C          	inc a
0899   0600 32 0F 10    	ld (__s_preparescreen + 0), a
0900   0603 C3 EC 05    	jp l_88
0901   0606             l_90: 
0902   0606             ; 63         printf("+\n");
0903   0606 21 73 0F    	ld hl, __c_10
0904   0609 E5          	push hl
0905   060A CD 31 05    	call printf
0906   060D C1          	pop bc
0907   060E             l_80: 
0908   060E 3A 10 10    	ld a, (__s_preparescreen + 1)
0909   0611 3C          	inc a
0910   0612 32 10 10    	ld (__s_preparescreen + 1), a
0911   0615 C3 A4 05    	jp l_79
0912   0618             l_81: 
0913   0618             ; 64     }
0914   0618             ; 65     printf("\n          w,a,s,d or r,q       \n");
0915   0618 21 DE 0E    	ld hl, __c_12
0916   061B E5          	push hl
0917   061C CD 31 05    	call printf
0918   061F C1          	pop bc
0919   0620             ; 66     drawBoard();
0920   0620 C3 1D 03    	jp drawboard
0921   0623             cpmbiosconin: 
0922   0623             ; 32  uint8_t __fastcall cpmBiosConIn() {
0923   0623             
0924   0623 2A 01 00            ld hl, (1)
0925   0626 2E 09               ld l, 09h
0926   0628 E9                  jp hl
0927   0629                 
0928   0629 C9          	ret
0929   062A             rotateboard: 
0930   062A             ; 121  rotateBoard() {
0931   062A             ; 122     uint8_t i, j, n = SIZE;
0932   062A 3E 04       	ld a, 4
0933   062C 32 D6 0F    	ld (__s_rotateboard + 2), a
0934   062F             ; 123     uint8_t tmp;
0935   062F             ; 124     for (i = 0; i < n / 2; i++) {
0936   062F AF          	xor a
0937   0630 32 D4 0F    	ld (__s_rotateboard + 0), a
0938   0633             l_91: 
0939   0633 2A D6 0F    	ld hl, (__s_rotateboard + 2)
0940   0636 26 00       	ld h, 0
0941   0638 11 01 00    	ld de, 1
0942   063B CD C4 0D    	call __o_shr_u16
0943   063E EB          	ex hl, de
0944   063F 2A D4 0F    	ld hl, (__s_rotateboard + 0)
0945   0642 26 00       	ld h, 0
0946   0644 CD 6A 0D    	call __o_sub_16
0947   0647 D0          	ret nc
0948   0648             ; 125         for (j = i; j < n - i - 1; j++) {
0949   0648 3A D4 0F    	ld a, (__s_rotateboard + 0)
0950   064B 32 D5 0F    	ld (__s_rotateboard + 1), a
0951   064E             l_94: 
0952   064E 2A D4 0F    	ld hl, (__s_rotateboard + 0)
0953   0651 26 00       	ld h, 0
0954   0653 EB          	ex hl, de
0955   0654 2A D6 0F    	ld hl, (__s_rotateboard + 2)
0956   0657 26 00       	ld h, 0
0957   0659 CD 6A 0D    	call __o_sub_16
0958   065C 2B          	dec hl
0959   065D EB          	ex hl, de
0960   065E 2A D5 0F    	ld hl, (__s_rotateboard + 1)
0961   0661 26 00       	ld h, 0
0962   0663 CD 6A 0D    	call __o_sub_16
0963   0666 D2 69 07    	jp nc, l_96
0964   0669             ; 126             tmp = board[i][j];
0965   0669 2A D4 0F    	ld hl, (__s_rotateboard + 0)
0966   066C 26 00       	ld h, 0
0967   066E 29          	add hl, hl
0968   066F 29          	add hl, hl
0969   0670 11 BE 0F    	ld de, board
0970   0673 19          	add hl, de
0971   0674 EB          	ex hl, de
0972   0675 2A D5 0F    	ld hl, (__s_rotateboard + 1)
0973   0678 26 00       	ld h, 0
0974   067A 19          	add hl, de
0975   067B 7E          	ld a, (hl)
0976   067C 32 D7 0F    	ld (__s_rotateboard + 3), a
0977   067F             ; 127             board[i][j] = board[j][n - i - 1];
0978   067F 2A D4 0F    	ld hl, (__s_rotateboard + 0)
0979   0682 26 00       	ld h, 0
0980   0684 EB          	ex hl, de
0981   0685 2A D6 0F    	ld hl, (__s_rotateboard + 2)
0982   0688 26 00       	ld h, 0
0983   068A CD 6A 0D    	call __o_sub_16
0984   068D 2B          	dec hl
0985   068E E5          	push hl
0986   068F 2A D5 0F    	ld hl, (__s_rotateboard + 1)
0987   0692 26 00       	ld h, 0
0988   0694 29          	add hl, hl
0989   0695 29          	add hl, hl
0990   0696 11 BE 0F    	ld de, board
0991   0699 19          	add hl, de
0992   069A D1          	pop de
0993   069B 19          	add hl, de
0994   069C 7E          	ld a, (hl)
0995   069D 2A D4 0F    	ld hl, (__s_rotateboard + 0)
0996   06A0 26 00       	ld h, 0
0997   06A2 29          	add hl, hl
0998   06A3 29          	add hl, hl
0999   06A4 11 BE 0F    	ld de, board
1000   06A7 19          	add hl, de
1001   06A8 EB          	ex hl, de
1002   06A9 2A D5 0F    	ld hl, (__s_rotateboard + 1)
1003   06AC 26 00       	ld h, 0
1004   06AE 19          	add hl, de
1005   06AF 77          	ld (hl), a
1006   06B0             ; 128             board[j][n - i - 1] = board[n - i - 1][n - j - 1];
1007   06B0 2A D4 0F    	ld hl, (__s_rotateboard + 0)
1008   06B3 26 00       	ld h, 0
1009   06B5 EB          	ex hl, de
1010   06B6 2A D6 0F    	ld hl, (__s_rotateboard + 2)
1011   06B9 26 00       	ld h, 0
1012   06BB CD 6A 0D    	call __o_sub_16
1013   06BE 2B          	dec hl
1014   06BF E5          	push hl
1015   06C0 2A D5 0F    	ld hl, (__s_rotateboard + 1)
1016   06C3 26 00       	ld h, 0
1017   06C5 29          	add hl, hl
1018   06C6 29          	add hl, hl
1019   06C7 11 BE 0F    	ld de, board
1020   06CA 19          	add hl, de
1021   06CB D1          	pop de
1022   06CC 19          	add hl, de
1023   06CD E5          	push hl
1024   06CE 2A D5 0F    	ld hl, (__s_rotateboard + 1)
1025   06D1 26 00       	ld h, 0
1026   06D3 EB          	ex hl, de
1027   06D4 2A D6 0F    	ld hl, (__s_rotateboard + 2)
1028   06D7 26 00       	ld h, 0
1029   06D9 CD 6A 0D    	call __o_sub_16
1030   06DC 2B          	dec hl
1031   06DD E5          	push hl
1032   06DE 2A D4 0F    	ld hl, (__s_rotateboard + 0)
1033   06E1 26 00       	ld h, 0
1034   06E3 EB          	ex hl, de
1035   06E4 2A D6 0F    	ld hl, (__s_rotateboard + 2)
1036   06E7 26 00       	ld h, 0
1037   06E9 CD 6A 0D    	call __o_sub_16
1038   06EC 2B          	dec hl
1039   06ED 29          	add hl, hl
1040   06EE 29          	add hl, hl
1041   06EF 11 BE 0F    	ld de, board
1042   06F2 19          	add hl, de
1043   06F3 D1          	pop de
1044   06F4 19          	add hl, de
1045   06F5 7E          	ld a, (hl)
1046   06F6 E1          	pop hl
1047   06F7 77          	ld (hl), a
1048   06F8             ; 129             board[n - i - 1][n - j - 1] = board[n - j - 1][i];
1049   06F8 2A D5 0F    	ld hl, (__s_rotateboard + 1)
1050   06FB 26 00       	ld h, 0
1051   06FD EB          	ex hl, de
1052   06FE 2A D6 0F    	ld hl, (__s_rotateboard + 2)
1053   0701 26 00       	ld h, 0
1054   0703 CD 6A 0D    	call __o_sub_16
1055   0706 2B          	dec hl
1056   0707 E5          	push hl
1057   0708 2A D4 0F    	ld hl, (__s_rotateboard + 0)
1058   070B 26 00       	ld h, 0
1059   070D EB          	ex hl, de
1060   070E 2A D6 0F    	ld hl, (__s_rotateboard + 2)
1061   0711 26 00       	ld h, 0
1062   0713 CD 6A 0D    	call __o_sub_16
1063   0716 2B          	dec hl
1064   0717 29          	add hl, hl
1065   0718 29          	add hl, hl
1066   0719 11 BE 0F    	ld de, board
1067   071C 19          	add hl, de
1068   071D D1          	pop de
1069   071E 19          	add hl, de
1070   071F E5          	push hl
1071   0720 2A D5 0F    	ld hl, (__s_rotateboard + 1)
1072   0723 26 00       	ld h, 0
1073   0725 EB          	ex hl, de
1074   0726 2A D6 0F    	ld hl, (__s_rotateboard + 2)
1075   0729 26 00       	ld h, 0
1076   072B CD 6A 0D    	call __o_sub_16
1077   072E 2B          	dec hl
1078   072F 29          	add hl, hl
1079   0730 29          	add hl, hl
1080   0731 11 BE 0F    	ld de, board
1081   0734 19          	add hl, de
1082   0735 EB          	ex hl, de
1083   0736 2A D4 0F    	ld hl, (__s_rotateboard + 0)
1084   0739 26 00       	ld h, 0
1085   073B 19          	add hl, de
1086   073C 7E          	ld a, (hl)
1087   073D E1          	pop hl
1088   073E 77          	ld (hl), a
1089   073F             ; 130             board[n - j - 1][i] = tmp;
1090   073F 2A D5 0F    	ld hl, (__s_rotateboard + 1)
1091   0742 26 00       	ld h, 0
1092   0744 EB          	ex hl, de
1093   0745 2A D6 0F    	ld hl, (__s_rotateboard + 2)
1094   0748 26 00       	ld h, 0
1095   074A CD 6A 0D    	call __o_sub_16
1096   074D 2B          	dec hl
1097   074E 29          	add hl, hl
1098   074F 29          	add hl, hl
1099   0750 11 BE 0F    	ld de, board
1100   0753 19          	add hl, de
1101   0754 EB          	ex hl, de
1102   0755 2A D4 0F    	ld hl, (__s_rotateboard + 0)
1103   0758 26 00       	ld h, 0
1104   075A 19          	add hl, de
1105   075B 3A D7 0F    	ld a, (__s_rotateboard + 3)
1106   075E 77          	ld (hl), a
1107   075F             l_95: 
1108   075F 3A D5 0F    	ld a, (__s_rotateboard + 1)
1109   0762 3C          	inc a
1110   0763 32 D5 0F    	ld (__s_rotateboard + 1), a
1111   0766 C3 4E 06    	jp l_94
1112   0769             l_96: 
1113   0769             l_92: 
1114   0769 3A D4 0F    	ld a, (__s_rotateboard + 0)
1115   076C 3C          	inc a
1116   076D 32 D4 0F    	ld (__s_rotateboard + 0), a
1117   0770 C3 33 06    	jp l_91
1118   0773             slidearray: 
1119   0773             ; 93  slideArray(uint8_t array[SIZE]) {
1120   0773 22 DD 0F    	ld (__a_1_slidearray), hl
1121   0776             ; 94     bool success = false;
1122   0776             ; 24 ;
1123   0776 AF          	xor a
1124   0777 32 D9 0F    	ld (__s_slidearray + 0), a
1125   077A             ; 95  x, t, stop = 0;
1126   077A 32 DC 0F    	ld (__s_slidearray + 3), a
1127   077D             ; 96 
1128   077D             ; 97     for (x = 0; x < SIZE; x++) {
1129   077D 32 DA 0F    	ld (__s_slidearray + 1), a
1130   0780             l_97: 
1131   0780 3A DA 0F    	ld a, (__s_slidearray + 1)
1132   0783 FE 04       	cp 4
1133   0785 D2 53 08    	jp nc, l_99
1134   0788             ; 98         if (array[x] != 0) {
1135   0788 2A DA 0F    	ld hl, (__s_slidearray + 1)
1136   078B 26 00       	ld h, 0
1137   078D EB          	ex hl, de
1138   078E 2A DD 0F    	ld hl, (__a_1_slidearray)
1139   0791 19          	add hl, de
1140   0792 7E          	ld a, (hl)
1141   0793 B7          	or a
1142   0794 CA 49 08    	jp z, l_100
1143   0797             ; 99             t = findTarget(array, x, stop);
1144   0797 2A DD 0F    	ld hl, (__a_1_slidearray)
1145   079A 22 D5 0F    	ld (__a_1_findtarget), hl
1146   079D 3A DA 0F    	ld a, (__s_slidearray + 1)
1147   07A0 32 D7 0F    	ld (__a_2_findtarget), a
1148   07A3 3A DC 0F    	ld a, (__s_slidearray + 3)
1149   07A6 CD DF 0B    	call findtarget
1150   07A9 32 DB 0F    	ld (__s_slidearray + 2), a
1151   07AC             ; 100             // if target is not original position, then move or merge
1152   07AC             ; 101             if (t != x) {
1153   07AC 3A DA 0F    	ld a, (__s_slidearray + 1)
1154   07AF 21 DB 0F    	ld hl, __s_slidearray + 2
1155   07B2 BE          	cp (hl)
1156   07B3 CA 49 08    	jp z, l_102
1157   07B6             ; 102                 // if target is zero, this is a move
1158   07B6             ; 103                 if (array[t] == 0) {
1159   07B6 2A DB 0F    	ld hl, (__s_slidearray + 2)
1160   07B9 26 00       	ld h, 0
1161   07BB EB          	ex hl, de
1162   07BC 2A DD 0F    	ld hl, (__a_1_slidearray)
1163   07BF 19          	add hl, de
1164   07C0 7E          	ld a, (hl)
1165   07C1 B7          	or a
1166   07C2 C2 DE 07    	jp nz, l_104
1167   07C5             ; 104                     array[t] = array[x];
1168   07C5 2A DA 0F    	ld hl, (__s_slidearray + 1)
1169   07C8 26 00       	ld h, 0
1170   07CA EB          	ex hl, de
1171   07CB 2A DD 0F    	ld hl, (__a_1_slidearray)
1172   07CE 19          	add hl, de
1173   07CF 7E          	ld a, (hl)
1174   07D0 2A DB 0F    	ld hl, (__s_slidearray + 2)
1175   07D3 26 00       	ld h, 0
1176   07D5 EB          	ex hl, de
1177   07D6 2A DD 0F    	ld hl, (__a_1_slidearray)
1178   07D9 19          	add hl, de
1179   07DA 77          	ld (hl), a
1180   07DB C3 38 08    	jp l_105
1181   07DE             l_104: 
1182   07DE             ; 105                 } else if (array[t] == array[x]) {
1183   07DE 2A DA 0F    	ld hl, (__s_slidearray + 1)
1184   07E1 26 00       	ld h, 0
1185   07E3 EB          	ex hl, de
1186   07E4 2A DD 0F    	ld hl, (__a_1_slidearray)
1187   07E7 19          	add hl, de
1188   07E8 7E          	ld a, (hl)
1189   07E9 2A DB 0F    	ld hl, (__s_slidearray + 2)
1190   07EC 26 00       	ld h, 0
1191   07EE EB          	ex hl, de
1192   07EF 2A DD 0F    	ld hl, (__a_1_slidearray)
1193   07F2 19          	add hl, de
1194   07F3 BE          	cp (hl)
1195   07F4 C2 38 08    	jp nz, l_106
1196   07F7             ; 106                     // merge (increase power of two)
1197   07F7             ; 107                     array[t]++;
1198   07F7 2A DB 0F    	ld hl, (__s_slidearray + 2)
1199   07FA 26 00       	ld h, 0
1200   07FC EB          	ex hl, de
1201   07FD 2A DD 0F    	ld hl, (__a_1_slidearray)
1202   0800 19          	add hl, de
1203   0801 7E          	ld a, (hl)
1204   0802 3C          	inc a
1205   0803 77          	ld (hl), a
1206   0804             ; 108                     // increase score
1207   0804             ; 109                     score += (uint32_t)1 << array[t];
1208   0804 2A B9 0F    	ld hl, (((score) + 2))
1209   0807 EB          	ex hl, de
1210   0808 2A B7 0F    	ld hl, (score)
1211   080B D5          	push de
1212   080C E5          	push hl
1213   080D 11 00 00    	ld de, 0
1214   0810 21 01 00    	ld hl, 1
1215   0813 D5          	push de
1216   0814 E5          	push hl
1217   0815 2A DB 0F    	ld hl, (__s_slidearray + 2)
1218   0818 26 00       	ld h, 0
1219   081A EB          	ex hl, de
1220   081B 2A DD 0F    	ld hl, (__a_1_slidearray)
1221   081E 19          	add hl, de
1222   081F 6E          	ld l, (hl)
1223   0820 11 00 00    	ld de, 0
1224   0823 62          	ld h, d
1225   0824 CD AF 0E    	call __o_shl_32
1226   0827 CD D1 0D    	call __o_add_32
1227   082A 22 B7 0F    	ld (score), hl
1228   082D EB          	ex hl, de
1229   082E 22 B9 0F    	ld ((score) + 2), hl
1230   0831             ; 110                     // set stop to avoid double merge
1231   0831             ; 111                     stop = t + 1;
1232   0831 3A DB 0F    	ld a, (__s_slidearray + 2)
1233   0834 3C          	inc a
1234   0835 32 DC 0F    	ld (__s_slidearray + 3), a
1235   0838             l_106: 
1236   0838             l_105: 
1237   0838             ; 112                 }
1238   0838             ; 113                 array[x] = 0;
1239   0838 2A DA 0F    	ld hl, (__s_slidearray + 1)
1240   083B 26 00       	ld h, 0
1241   083D EB          	ex hl, de
1242   083E 2A DD 0F    	ld hl, (__a_1_slidearray)
1243   0841 19          	add hl, de
1244   0842 36 00       	ld (hl), 0
1245   0844             ; 114                 success = true;
1246   0844             ; 25 ;
1247   0844 3E 01       	ld a, 1
1248   0846 32 D9 0F    	ld (__s_slidearray + 0), a
1249   0849             l_102: 
1250   0849             l_100: 
1251   0849             l_98: 
1252   0849             ; 97 ) {
1253   0849 3A DA 0F    	ld a, (__s_slidearray + 1)
1254   084C 3C          	inc a
1255   084D 32 DA 0F    	ld (__s_slidearray + 1), a
1256   0850 C3 80 07    	jp l_97
1257   0853             l_99: 
1258   0853             ; 98         if (array[x] != 0) {
1259   0853             ; 99             t = findTarget(array, x, stop);
1260   0853             ; 100             // if target is not original position, then move or merge
1261   0853             ; 101             if (t != x) {
1262   0853             ; 102                 // if target is zero, this is a move
1263   0853             ; 103                 if (array[t] == 0) {
1264   0853             ; 104                     array[t] = array[x];
1265   0853             ; 105                 } else if (array[t] == array[x]) {
1266   0853             ; 106                     // merge (increase power of two)
1267   0853             ; 107                     array[t]++;
1268   0853             ; 108                     // increase score
1269   0853             ; 109                     score += (uint32_t)1 << array[t];
1270   0853             ; 110                     // set stop to avoid double merge
1271   0853             ; 111                     stop = t + 1;
1272   0853             ; 112                 }
1273   0853             ; 113                 array[x] = 0;
1274   0853             ; 114                 success = true;
1275   0853             ; 115             }
1276   0853             ; 116         }
1277   0853             ; 117     }
1278   0853             ; 118     return success;
1279   0853 3A D9 0F    	ld a, (__s_slidearray + 0)
1280   0856 C9          	ret
1281   0857             snprintf: 
1282   0857             ; 32  __stdcall snprintf(char *buffer, size_t buffer_size, const char *format, ...) {
1283   0857 C5          	push bc
1284   0858             ; 33     va_list va;
1285   0858             ; 34     va_start(va, format);
1286   0858 21 0A 00    	ld hl, 10
1287   085B 39          	add hl, sp
1288   085C EB          	ex hl, de
1289   085D 21 00 00    	ld hl, 0
1290   0860 39          	add hl, sp
1291   0861 73          	ld (hl), e
1292   0862 23          	inc hl
1293   0863 72          	ld (hl), d
1294   0864             ; 35     __snprintf(buffer, buffer_size, format, va);
1295   0864 21 04 00    	ld hl, 4
1296   0867 39          	add hl, sp
1297   0868 5E          	ld e, (hl)
1298   0869 23          	inc hl
1299   086A 56          	ld d, (hl)
1300   086B EB          	ex hl, de
1301   086C 22 FA 0F    	ld (__a_1___snprintf), hl
1302   086F 21 06 00    	ld hl, 6
1303   0872 39          	add hl, sp
1304   0873 5E          	ld e, (hl)
1305   0874 23          	inc hl
1306   0875 56          	ld d, (hl)
1307   0876 EB          	ex hl, de
1308   0877 22 FC 0F    	ld (__a_2___snprintf), hl
1309   087A 21 08 00    	ld hl, 8
1310   087D 39          	add hl, sp
1311   087E 5E          	ld e, (hl)
1312   087F 23          	inc hl
1313   0880 56          	ld d, (hl)
1314   0881 EB          	ex hl, de
1315   0882 22 FE 0F    	ld (__a_3___snprintf), hl
1316   0885 21 00 00    	ld hl, 0
1317   0888 39          	add hl, sp
1318   0889 5E          	ld e, (hl)
1319   088A 23          	inc hl
1320   088B 56          	ld d, (hl)
1321   088C EB          	ex hl, de
1322   088D CD 3B 0C    	call __snprintf
1323   0890             ; 36     va_end(va);
1324   0890             ; 37     return __printf_out_total;
1325   0890 2A D2 0F    	ld hl, (__printf_out_total)
1326   0893 C1          	pop bc
1327   0894 C9          	ret
1328   0895             strlen: 
1329   0895             ; 20  __fastcall strlen(const char *string) {
1330   0895 22 D4 0F    	ld (__a_1_strlen), hl
1331   0898             ; 21     (void)string;
1332   0898             
1333   0898 11 FF FF            ld de, -1
1334   089B AF                  xor a
1335   089C             strlen_1: 
1336   089C BE                  cp (hl)
1337   089D 13                  inc de
1338   089E 23                  inc hl
1339   089F C2 9C 08            jp nz, strlen_1
1340   08A2 EB                  ex hl, de
1341   08A3                 
1342   08A3 C9          	ret
1343   08A4             delay: 
1344   08A4             ; 22  Delay(uint16_t n) {
1345   08A4 22 D4 0F    	ld (__a_1_delay), hl
1346   08A7             l_109: 
1347   08A7             ; 23     while (--n != 0) {
1348   08A7 2A D4 0F    	ld hl, (__a_1_delay)
1349   08AA 2B          	dec hl
1350   08AB 22 D4 0F    	ld (__a_1_delay), hl
1351   08AE 7C          	ld a, h
1352   08AF B5          	or l
1353   08B0 C2 A7 08    	jp nz, l_109
1354   08B3 C9          	ret
1355   08B4             rand: 
1356   08B4             ; 22  rand(void) {
1357   08B4             ; 23     __rand_seed ^= (__rand_seed << 13);
1358   08B4 2A BC 0F    	ld hl, (__rand_seed)
1359   08B7 65          	ld h, l
1360   08B8 2E 00       	ld l, 0
1361   08BA 29          	add hl, hl
1362   08BB 29          	add hl, hl
1363   08BC 29          	add hl, hl
1364   08BD 29          	add hl, hl
1365   08BE 29          	add hl, hl
1366   08BF EB          	ex hl, de
1367   08C0 2A BC 0F    	ld hl, (__rand_seed)
1368   08C3 CD 71 0D    	call __o_xor_16
1369   08C6 22 BC 0F    	ld (__rand_seed), hl
1370   08C9             ; 24     __rand_seed ^= (__rand_seed >> 9);
1371   08C9 11 09 00    	ld de, 9
1372   08CC CD C4 0D    	call __o_shr_u16
1373   08CF EB          	ex hl, de
1374   08D0 2A BC 0F    	ld hl, (__rand_seed)
1375   08D3 CD 71 0D    	call __o_xor_16
1376   08D6 22 BC 0F    	ld (__rand_seed), hl
1377   08D9             ; 25     __rand_seed ^= (__rand_seed << 7);
1378   08D9 29          	add hl, hl
1379   08DA 29          	add hl, hl
1380   08DB 29          	add hl, hl
1381   08DC 29          	add hl, hl
1382   08DD 29          	add hl, hl
1383   08DE 29          	add hl, hl
1384   08DF 29          	add hl, hl
1385   08E0 EB          	ex hl, de
1386   08E1 2A BC 0F    	ld hl, (__rand_seed)
1387   08E4 CD 71 0D    	call __o_xor_16
1388   08E7 22 BC 0F    	ld (__rand_seed), hl
1389   08EA             ; 26     return __rand_seed;
1390   08EA C9          	ret
1391   08EB             countempty: 
1392   08EB             ; 186  countEmpty() {
1393   08EB             ; 187     uint8_t x, y;
1394   08EB             ; 188     uint8_t count = 0;
1395   08EB AF          	xor a
1396   08EC 32 D6 0F    	ld (__s_countempty + 2), a
1397   08EF             ; 189     for (x = 0; x < SIZE; x++) {
1398   08EF 32 D4 0F    	ld (__s_countempty + 0), a
1399   08F2             l_111: 
1400   08F2 3A D4 0F    	ld a, (__s_countempty + 0)
1401   08F5 FE 04       	cp 4
1402   08F7 D2 38 09    	jp nc, l_113
1403   08FA             ; 190         for (y = 0; y < SIZE; y++) {
1404   08FA AF          	xor a
1405   08FB 32 D5 0F    	ld (__s_countempty + 1), a
1406   08FE             l_114: 
1407   08FE 3A D5 0F    	ld a, (__s_countempty + 1)
1408   0901 FE 04       	cp 4
1409   0903 D2 2E 09    	jp nc, l_116
1410   0906             ; 191             if (board[x][y] == 0) {
1411   0906 2A D4 0F    	ld hl, (__s_countempty + 0)
1412   0909 26 00       	ld h, 0
1413   090B 29          	add hl, hl
1414   090C 29          	add hl, hl
1415   090D 11 BE 0F    	ld de, board
1416   0910 19          	add hl, de
1417   0911 EB          	ex hl, de
1418   0912 2A D5 0F    	ld hl, (__s_countempty + 1)
1419   0915 26 00       	ld h, 0
1420   0917 19          	add hl, de
1421   0918 7E          	ld a, (hl)
1422   0919 B7          	or a
1423   091A C2 24 09    	jp nz, l_117
1424   091D             ; 192                 count++;
1425   091D 3A D6 0F    	ld a, (__s_countempty + 2)
1426   0920 3C          	inc a
1427   0921 32 D6 0F    	ld (__s_countempty + 2), a
1428   0924             l_117: 
1429   0924             l_115: 
1430   0924 3A D5 0F    	ld a, (__s_countempty + 1)
1431   0927 3C          	inc a
1432   0928 32 D5 0F    	ld (__s_countempty + 1), a
1433   092B C3 FE 08    	jp l_114
1434   092E             l_116: 
1435   092E             l_112: 
1436   092E 3A D4 0F    	ld a, (__s_countempty + 0)
1437   0931 3C          	inc a
1438   0932 32 D4 0F    	ld (__s_countempty + 0), a
1439   0935 C3 F2 08    	jp l_111
1440   0938             l_113: 
1441   0938             ; 193             }
1442   0938             ; 194         }
1443   0938             ; 195     }
1444   0938             ; 196     return count;
1445   0938 3A D6 0F    	ld a, (__s_countempty + 2)
1446   093B C9          	ret
1447   093C             findpairdown: 
1448   093C             ; 174  findPairDown() {
1449   093C             ; 175     bool success = false;
1450   093C             ; 24 ;
1451   093C AF          	xor a
1452   093D 32 D4 0F    	ld (__s_findpairdown + 0), a
1453   0940             ; 177  = 0; x < SIZE; x++) {
1454   0940 32 D5 0F    	ld (__s_findpairdown + 1), a
1455   0943             l_119: 
1456   0943 3A D5 0F    	ld a, (__s_findpairdown + 1)
1457   0946 FE 04       	cp 4
1458   0948 D2 98 09    	jp nc, l_121
1459   094B             ; 178         for (y = 0; y < SIZE - 1; y++) {
1460   094B AF          	xor a
1461   094C 32 D6 0F    	ld (__s_findpairdown + 2), a
1462   094F             l_122: 
1463   094F 3A D6 0F    	ld a, (__s_findpairdown + 2)
1464   0952 FE 03       	cp 3
1465   0954 D2 8E 09    	jp nc, l_124
1466   0957             ; 179             if (board[x][y] == board[x][y + 1])
1467   0957 2A D5 0F    	ld hl, (__s_findpairdown + 1)
1468   095A 26 00       	ld h, 0
1469   095C 29          	add hl, hl
1470   095D 29          	add hl, hl
1471   095E 11 BE 0F    	ld de, board
1472   0961 19          	add hl, de
1473   0962 EB          	ex hl, de
1474   0963 2A D6 0F    	ld hl, (__s_findpairdown + 2)
1475   0966 26 00       	ld h, 0
1476   0968 23          	inc hl
1477   0969 19          	add hl, de
1478   096A 7E          	ld a, (hl)
1479   096B 2A D5 0F    	ld hl, (__s_findpairdown + 1)
1480   096E 26 00       	ld h, 0
1481   0970 29          	add hl, hl
1482   0971 29          	add hl, hl
1483   0972 11 BE 0F    	ld de, board
1484   0975 19          	add hl, de
1485   0976 EB          	ex hl, de
1486   0977 2A D6 0F    	ld hl, (__s_findpairdown + 2)
1487   097A 26 00       	ld h, 0
1488   097C 19          	add hl, de
1489   097D BE          	cp (hl)
1490   097E C2 84 09    	jp nz, l_125
1491   0981             ; 25 ;
1492   0981 3E 01       	ld a, 1
1493   0983 C9          	ret
1494   0984             l_125: 
1495   0984             l_123: 
1496   0984             ; 178 ) {
1497   0984 3A D6 0F    	ld a, (__s_findpairdown + 2)
1498   0987 3C          	inc a
1499   0988 32 D6 0F    	ld (__s_findpairdown + 2), a
1500   098B C3 4F 09    	jp l_122
1501   098E             l_124: 
1502   098E             l_120: 
1503   098E 3A D5 0F    	ld a, (__s_findpairdown + 1)
1504   0991 3C          	inc a
1505   0992 32 D5 0F    	ld (__s_findpairdown + 1), a
1506   0995 C3 43 09    	jp l_119
1507   0998             l_121: 
1508   0998             ; 179             if (board[x][y] == board[x][y + 1])
1509   0998             ; 180                 return true;
1510   0998             ; 181         }
1511   0998             ; 182     }
1512   0998             ; 183     return success;
1513   0998 3A D4 0F    	ld a, (__s_findpairdown + 0)
1514   099B C9          	ret
1515   099C             __printf: 
1516   099C             ; 73  __printf(const char *format, va_list va) {
1517   099C 22 F6 0F    	ld (__a_2___printf), hl
1518   099F             ; 74     __printf_out_total = 0;
1519   099F 21 00 00    	ld hl, 0
1520   09A2 22 D2 0F    	ld (__printf_out_total), hl
1521   09A5             l_127: 
1522   09A5             ; 75     for (;;) {
1523   09A5             ; 76         uint8_t c = *format;
1524   09A5 2A F4 0F    	ld hl, (__a_1___printf)
1525   09A8 7E          	ld a, (hl)
1526   09A9 32 DD 0F    	ld (__s___printf + 0), a
1527   09AC             ; 77         switch (c) {
1528   09AC B7          	or a
1529   09AD C8          	ret z
1530   09AE D6 25       	sub 37
1531   09B0 CA B6 09    	jp z, l_131
1532   09B3 C3 CE 0B    	jp l_133
1533   09B6             l_131: 
1534   09B6             ; 78             case '\0':
1535   09B6             ; 79                 return;
1536   09B6             ; 80             case '%':
1537   09B6             ; 81                 unsigned width = 0;
1538   09B6 21 00 00    	ld hl, 0
1539   09B9 22 DE 0F    	ld (__s___printf + 1), hl
1540   09BC             ; 82                 format++;
1541   09BC 2A F4 0F    	ld hl, (__a_1___printf)
1542   09BF 23          	inc hl
1543   09C0 22 F4 0F    	ld (__a_1___printf), hl
1544   09C3             ; 83                 c = *format;
1545   09C3 7E          	ld a, (hl)
1546   09C4 32 DD 0F    	ld (__s___printf + 0), a
1547   09C7             ; 84                 char fill_char = c == '0' ? '0' : ' ';
1548   09C7 FE 30       	cp 48
1549   09C9 C2 D2 09    	jp nz, l_134
1550   09CC 21 30 00    	ld hl, 48
1551   09CF C3 D5 09    	jp l_135
1552   09D2             l_134: 
1553   09D2 21 20 00    	ld hl, 32
1554   09D5             l_135: 
1555   09D5 7D          	ld a, l
1556   09D6 32 E0 0F    	ld (__s___printf + 3), a
1557   09D9             ; 85                 if (c == '*') {
1558   09D9 3A DD 0F    	ld a, (__s___printf + 0)
1559   09DC FE 2A       	cp 42
1560   09DE C2 00 0A    	jp nz, l_136
1561   09E1             ; 86                     width = va_arg(va, unsigned);
1562   09E1 2A F6 0F    	ld hl, (__a_2___printf)
1563   09E4 23          	inc hl
1564   09E5 23          	inc hl
1565   09E6 22 F6 0F    	ld (__a_2___printf), hl
1566   09E9 2B          	dec hl
1567   09EA 2B          	dec hl
1568   09EB 5E          	ld e, (hl)
1569   09EC 23          	inc hl
1570   09ED 56          	ld d, (hl)
1571   09EE EB          	ex hl, de
1572   09EF 22 DE 0F    	ld (__s___printf + 1), hl
1573   09F2             ; 87                     format++;
1574   09F2 2A F4 0F    	ld hl, (__a_1___printf)
1575   09F5 23          	inc hl
1576   09F6 22 F4 0F    	ld (__a_1___printf), hl
1577   09F9             ; 88                     c = *format;
1578   09F9 7E          	ld a, (hl)
1579   09FA 32 DD 0F    	ld (__s___printf + 0), a
1580   09FD C3 37 0A    	jp l_137
1581   0A00             l_136: 
1582   0A00             l_138: 
1583   0A00             ; 89                 } else {
1584   0A00             ; 90                     while (c >= '0' && c <= '9') {
1585   0A00 3A DD 0F    	ld a, (__s___printf + 0)
1586   0A03 FE 30       	cp 48
1587   0A05 DA 37 0A    	jp c, l_139
1588   0A08 3E 39       	ld a, 57
1589   0A0A 21 DD 0F    	ld hl, __s___printf + 0
1590   0A0D BE          	cp (hl)
1591   0A0E DA 37 0A    	jp c, l_139
1592   0A11             ; 91                         width = width * 10 + (c - '0');
1593   0A11 2A DD 0F    	ld hl, (__s___printf + 0)
1594   0A14 26 00       	ld h, 0
1595   0A16 11 D0 FF    	ld de, 65488
1596   0A19 19          	add hl, de
1597   0A1A E5          	push hl
1598   0A1B 2A DE 0F    	ld hl, (__s___printf + 1)
1599   0A1E 54          	ld d, h
1600   0A1F 5D          	ld e, l
1601   0A20 29          	add hl, hl
1602   0A21 29          	add hl, hl
1603   0A22 19          	add hl, de
1604   0A23 29          	add hl, hl
1605   0A24 D1          	pop de
1606   0A25 19          	add hl, de
1607   0A26 22 DE 0F    	ld (__s___printf + 1), hl
1608   0A29             ; 92                         format++;
1609   0A29 2A F4 0F    	ld hl, (__a_1___printf)
1610   0A2C 23          	inc hl
1611   0A2D 22 F4 0F    	ld (__a_1___printf), hl
1612   0A30             ; 93                         c = *format;
1613   0A30 7E          	ld a, (hl)
1614   0A31 32 DD 0F    	ld (__s___printf + 0), a
1615   0A34 C3 00 0A    	jp l_138
1616   0A37             l_139: 
1617   0A37             l_137: 
1618   0A37             ; 94                     }
1619   0A37             ; 95                 }
1620   0A37             ; 96 #ifndef C8080_PRINTF_NO_LONG
1621   0A37             ; 97                 uint8_t longMode = 0;
1622   0A37 AF          	xor a
1623   0A38 32 E1 0F    	ld (__s___printf + 4), a
1624   0A3B             ; 98                 if (c == 'l') {
1625   0A3B 3A DD 0F    	ld a, (__s___printf + 0)
1626   0A3E FE 6C       	cp 108
1627   0A40 C2 53 0A    	jp nz, l_140
1628   0A43             ; 99                     longMode = 1;
1629   0A43 3E 01       	ld a, 1
1630   0A45 32 E1 0F    	ld (__s___printf + 4), a
1631   0A48             ; 100                     format++;
1632   0A48 2A F4 0F    	ld hl, (__a_1___printf)
1633   0A4B 23          	inc hl
1634   0A4C 22 F4 0F    	ld (__a_1___printf), hl
1635   0A4F             ; 101                     c = *format;
1636   0A4F 7E          	ld a, (hl)
1637   0A50 32 DD 0F    	ld (__s___printf + 0), a
1638   0A53             l_140: 
1639   0A53             ; 102                 }
1640   0A53             ; 103 #endif
1641   0A53             ; 104                 uint8_t radix = 10;
1642   0A53 3E 0A       	ld a, 10
1643   0A55 32 E2 0F    	ld (__s___printf + 5), a
1644   0A58             ; 105                 switch (c) {
1645   0A58 3A DD 0F    	ld a, (__s___printf + 0)
1646   0A5B B7          	or a
1647   0A5C C8          	ret z
1648   0A5D D6 25       	sub 37
1649   0A5F CA 94 0B    	jp z, l_144
1650   0A62 D6 33       	sub 51
1651   0A64 CA 91 0A    	jp z, l_151
1652   0A67 D6 0B       	sub 11
1653   0A69 CA 5F 0B    	jp z, l_146
1654   0A6C 3D          	dec a
1655   0A6D CA 91 0A    	jp z, l_148
1656   0A70 D6 05       	sub 5
1657   0A72 CA 91 0A    	jp z, l_147
1658   0A75 D6 05       	sub 5
1659   0A77 CA 76 0B    	jp z, l_145
1660   0A7A D6 02       	sub 2
1661   0A7C CA 91 0A    	jp z, l_150
1662   0A7F D6 03       	sub 3
1663   0A81 CA 9C 0B    	jp z, l_143
1664   0A84 D6 02       	sub 2
1665   0A86 CA 91 0A    	jp z, l_149
1666   0A89 D6 03       	sub 3
1667   0A8B CA 91 0A    	jp z, l_152
1668   0A8E C3 D4 0B    	jp l_130
1669   0A91             l_152: 
1670   0A91             l_151: 
1671   0A91             l_150: 
1672   0A91             l_149: 
1673   0A91             l_148: 
1674   0A91             l_147: 
1675   0A91             ; 106                     case 0:
1676   0A91             ; 107                         return;
1677   0A91             ; 108                     // TODO: o  radix = 8
1678   0A91             ; 109                     case 'x':
1679   0A91             ; 110                     case 'X':
1680   0A91             ; 111                     case 'p':
1681   0A91             ; 112                     case 'u':
1682   0A91             ; 113                     case 'd':
1683   0A91             ; 114                     case 'i': {
1684   0A91             ; 115 #ifndef C8080_PRINTF_NO_LONG
1685   0A91             ; 116                         char buf[UINT32_TO_STRING_SIZE];
1686   0A91             ; 117                         uint32_t value32 = longMode ? va_arg(va, uint32_t) : va_arg(va, uint16_t);
1687   0A91 3A E1 0F    	ld a, (__s___printf + 4)
1688   0A94 B7          	or a
1689   0A95 CA AC 0A    	jp z, l_154
1690   0A98 2A F6 0F    	ld hl, (__a_2___printf)
1691   0A9B 11 04 00    	ld de, 4
1692   0A9E 19          	add hl, de
1693   0A9F 22 F6 0F    	ld (__a_2___printf), hl
1694   0AA2 11 FC FF    	ld de, 65532
1695   0AA5 19          	add hl, de
1696   0AA6 CD 04 0E    	call __o_load_32
1697   0AA9 C3 BD 0A    	jp l_155
1698   0AAC             l_154: 
1699   0AAC 2A F6 0F    	ld hl, (__a_2___printf)
1700   0AAF 23          	inc hl
1701   0AB0 23          	inc hl
1702   0AB1 22 F6 0F    	ld (__a_2___printf), hl
1703   0AB4 2B          	dec hl
1704   0AB5 2B          	dec hl
1705   0AB6 5E          	ld e, (hl)
1706   0AB7 23          	inc hl
1707   0AB8 56          	ld d, (hl)
1708   0AB9 EB          	ex hl, de
1709   0ABA 11 00 00    	ld de, 0
1710   0ABD             l_155: 
1711   0ABD 22 EE 0F    	ld (__s___printf + 17), hl
1712   0AC0 EB          	ex hl, de
1713   0AC1 22 F0 0F    	ld ((__s___printf + 17) + 2), hl
1714   0AC4             ; 118                         if (c == 'i' || c == 'd') {
1715   0AC4 3A DD 0F    	ld a, (__s___printf + 0)
1716   0AC7 FE 69       	cp 105
1717   0AC9 CA D1 0A    	jp z, l_158
1718   0ACC FE 64       	cp 100
1719   0ACE C2 10 0B    	jp nz, l_156
1720   0AD1             l_158: 
1721   0AD1             ; 119                             if (!longMode) {
1722   0AD1 3A E1 0F    	ld a, (__s___printf + 4)
1723   0AD4 B7          	or a
1724   0AD5 C2 E8 0A    	jp nz, l_159
1725   0AD8             ; 120                                 int16_t value = value32;  // TODO: OPTIMIZE
1726   0AD8 2A EE 0F    	ld hl, (__s___printf + 17)
1727   0ADB 22 F2 0F    	ld (__s___printf + 21), hl
1728   0ADE             ; 121                                 value32 = value;
1729   0ADE CD FB 0D    	call __o_i16_to_i32
1730   0AE1 22 EE 0F    	ld (__s___printf + 17), hl
1731   0AE4 EB          	ex hl, de
1732   0AE5 22 F0 0F    	ld ((__s___printf + 17) + 2), hl
1733   0AE8             l_159: 
1734   0AE8             ; 122                             }
1735   0AE8             ; 123                             if ((int32_t)value32 < 0) {
1736   0AE8 2A F0 0F    	ld hl, (((__s___printf + 17) + 2))
1737   0AEB EB          	ex hl, de
1738   0AEC D5          	push de
1739   0AED E5          	push hl
1740   0AEE 11 00 00    	ld de, 0
1741   0AF1 21 00 00    	ld hl, 0
1742   0AF4 CD E6 0D    	call __o_sub_32
1743   0AF7 F2 10 0B    	jp p, l_161
1744   0AFA             ; 124                                 __printf_out('-');
1745   0AFA 3E 2D       	ld a, 45
1746   0AFC CD 73 0C    	call __printf_out
1747   0AFF             ; 125                                 value32 = -value32;
1748   0AFF 2A F0 0F    	ld hl, (((__s___printf + 17) + 2))
1749   0B02 EB          	ex hl, de
1750   0B03 2A EE 0F    	ld hl, (__s___printf + 17)
1751   0B06 CD C8 0E    	call __o_minus_32
1752   0B09 22 EE 0F    	ld (__s___printf + 17), hl
1753   0B0C EB          	ex hl, de
1754   0B0D 22 F0 0F    	ld ((__s___printf + 17) + 2), hl
1755   0B10             l_161: 
1756   0B10             l_156: 
1757   0B10             ; 126                             }
1758   0B10             ; 127                         }
1759   0B10             ; 128                         char *text = Uint32ToString(buf, value32, (c == 'x' || c == 'p') ? 16 : 10);
1760   0B10 21 E3 0F    	ld hl, __s___printf + 6
1761   0B13 22 D5 0F    	ld (__a_1_uint32tostring), hl
1762   0B16 2A F0 0F    	ld hl, (((__s___printf + 17) + 2))
1763   0B19 EB          	ex hl, de
1764   0B1A 2A EE 0F    	ld hl, (__s___printf + 17)
1765   0B1D 22 D7 0F    	ld (__a_2_uint32tostring), hl
1766   0B20 EB          	ex hl, de
1767   0B21 22 D9 0F    	ld ((__a_2_uint32tostring) + 2), hl
1768   0B24 3A DD 0F    	ld a, (__s___printf + 0)
1769   0B27 FE 78       	cp 120
1770   0B29 CA 31 0B    	jp z, l_165
1771   0B2C FE 70       	cp 112
1772   0B2E C2 37 0B    	jp nz, l_163
1773   0B31             l_165: 
1774   0B31 21 10 00    	ld hl, 16
1775   0B34 C3 3A 0B    	jp l_164
1776   0B37             l_163: 
1777   0B37 21 0A 00    	ld hl, 10
1778   0B3A             l_164: 
1779   0B3A 7D          	ld a, l
1780   0B3B CD A5 0C    	call uint32tostring
1781   0B3E 22 F2 0F    	ld (__s___printf + 21), hl
1782   0B41             ; 129 #else
1783   0B41             ; 130                         char buf[UINT16_TO_STRING_SIZE];
1784   0B41             ; 131                         uint16_t value16 = va_arg(va, uint16_t);
1785   0B41             ; 132                         if ((c == 'i' || c == 'd') && (int16_t)value16 < 0) {
1786   0B41             ; 133                             __printf_out('-');
1787   0B41             ; 134                             value16 = 0 - value16;
1788   0B41             ; 135                         }
1789   0B41             ; 136                         char *text = Uint16ToString(buf, value16, (c == 'x' || c == 'p') ? 16 : 10);
1790   0B41             ; 137 #endif
1791   0B41             ; 138                         __printf_spaces(width, strlen(text), fill_char);
1792   0B41 2A DE 0F    	ld hl, (__s___printf + 1)
1793   0B44 22 D8 0F    	ld (__a_1___printf_spaces), hl
1794   0B47 2A F2 0F    	ld hl, (__s___printf + 21)
1795   0B4A CD 95 08    	call strlen
1796   0B4D 22 DA 0F    	ld (__a_2___printf_spaces), hl
1797   0B50 3A E0 0F    	ld a, (__s___printf + 3)
1798   0B53 CD FA 0C    	call __printf_spaces
1799   0B56             ; 139                         __printf_text(text);
1800   0B56 2A F2 0F    	ld hl, (__s___printf + 21)
1801   0B59 CD 2B 0D    	call __printf_text
1802   0B5C C3 D4 0B    	jp l_130
1803   0B5F             l_146: 
1804   0B5F             ; 140                         break;
1805   0B5F             ; 141                     }
1806   0B5F             ; 142                     case 'c': {
1807   0B5F             ; 143                         __printf_out(va_arg(va, uint16_t) & 0xFF);
1808   0B5F 2A F6 0F    	ld hl, (__a_2___printf)
1809   0B62 23          	inc hl
1810   0B63 23          	inc hl
1811   0B64 22 F6 0F    	ld (__a_2___printf), hl
1812   0B67 2B          	dec hl
1813   0B68 2B          	dec hl
1814   0B69 5E          	ld e, (hl)
1815   0B6A 23          	inc hl
1816   0B6B 56          	ld d, (hl)
1817   0B6C EB          	ex hl, de
1818   0B6D 7D          	ld a, l
1819   0B6E E6 FF       	and 255
1820   0B70 CD 73 0C    	call __printf_out
1821   0B73 C3 D4 0B    	jp l_130
1822   0B76             l_145: 
1823   0B76             ; 144                         break;
1824   0B76             ; 145                     }
1825   0B76             ; 146                     case 'n': {
1826   0B76             ; 147                         size_t *out = va_arg(va, size_t *);
1827   0B76 2A F6 0F    	ld hl, (__a_2___printf)
1828   0B79 23          	inc hl
1829   0B7A 23          	inc hl
1830   0B7B 22 F6 0F    	ld (__a_2___printf), hl
1831   0B7E 2B          	dec hl
1832   0B7F 2B          	dec hl
1833   0B80 5E          	ld e, (hl)
1834   0B81 23          	inc hl
1835   0B82 56          	ld d, (hl)
1836   0B83 EB          	ex hl, de
1837   0B84 22 E3 0F    	ld (__s___printf + 6), hl
1838   0B87             ; 148                         *out = __printf_out_total;
1839   0B87 2A D2 0F    	ld hl, (__printf_out_total)
1840   0B8A EB          	ex hl, de
1841   0B8B 2A E3 0F    	ld hl, (__s___printf + 6)
1842   0B8E 73          	ld (hl), e
1843   0B8F 23          	inc hl
1844   0B90 72          	ld (hl), d
1845   0B91 C3 D4 0B    	jp l_130
1846   0B94             l_144: 
1847   0B94             ; 149                         break;
1848   0B94             ; 150                     }
1849   0B94             ; 151                     case '%':
1850   0B94             ; 152                         __printf_out('%');
1851   0B94 3E 25       	ld a, 37
1852   0B96 CD 73 0C    	call __printf_out
1853   0B99 C3 D4 0B    	jp l_130
1854   0B9C             l_143: 
1855   0B9C             ; 153                         break;
1856   0B9C             ; 154                     case 's': {
1857   0B9C             ; 155                         uint16_t prevTotal = __printf_out_total;
1858   0B9C 2A D2 0F    	ld hl, (__printf_out_total)
1859   0B9F 22 E3 0F    	ld (__s___printf + 6), hl
1860   0BA2             ; 156                         __printf_text(va_arg(va, char *));
1861   0BA2 2A F6 0F    	ld hl, (__a_2___printf)
1862   0BA5 23          	inc hl
1863   0BA6 23          	inc hl
1864   0BA7 22 F6 0F    	ld (__a_2___printf), hl
1865   0BAA 2B          	dec hl
1866   0BAB 2B          	dec hl
1867   0BAC 5E          	ld e, (hl)
1868   0BAD 23          	inc hl
1869   0BAE 56          	ld d, (hl)
1870   0BAF EB          	ex hl, de
1871   0BB0 CD 2B 0D    	call __printf_text
1872   0BB3             ; 157                         __printf_spaces(width, __printf_out_total - prevTotal, ' ');
1873   0BB3 2A DE 0F    	ld hl, (__s___printf + 1)
1874   0BB6 22 D8 0F    	ld (__a_1___printf_spaces), hl
1875   0BB9 2A E3 0F    	ld hl, (__s___printf + 6)
1876   0BBC EB          	ex hl, de
1877   0BBD 2A D2 0F    	ld hl, (__printf_out_total)
1878   0BC0 CD 6A 0D    	call __o_sub_16
1879   0BC3 22 DA 0F    	ld (__a_2___printf_spaces), hl
1880   0BC6 3E 20       	ld a, 32
1881   0BC8 CD FA 0C    	call __printf_spaces
1882   0BCB C3 D4 0B    	jp l_130
1883   0BCE             l_133: 
1884   0BCE             ; 158                         break;
1885   0BCE             ; 159                     }
1886   0BCE             ; 160                 }
1887   0BCE             ; 161                 break;
1888   0BCE             ; 162             default:
1889   0BCE             ; 163                 __printf_out(c);
1890   0BCE 3A DD 0F    	ld a, (__s___printf + 0)
1891   0BD1 CD 73 0C    	call __printf_out
1892   0BD4             l_130: 
1893   0BD4             ; 164         }
1894   0BD4             ; 165         format++;
1895   0BD4 2A F4 0F    	ld hl, (__a_1___printf)
1896   0BD7 23          	inc hl
1897   0BD8 22 F4 0F    	ld (__a_1___printf), hl
1898   0BDB             l_128: 
1899   0BDB C3 A5 09    	jp l_127
1900   0BDE             l_129: 
1901   0BDE C9          	ret
1902   0BDF             findtarget: 
1903   0BDF             ; 69  findTarget(uint8_t array[SIZE], uint8_t x, uint8_t stop) {
1904   0BDF 32 D8 0F    	ld (__a_3_findtarget), a
1905   0BE2             ; 70     uint8_t t;
1906   0BE2             ; 71     // if the position is already on the first, don't evaluate
1907   0BE2             ; 72     if (x == 0) {
1908   0BE2 3A D7 0F    	ld a, (__a_2_findtarget)
1909   0BE5 B7          	or a
1910   0BE6 C2 EA 0B    	jp nz, l_166
1911   0BE9             ; 73         return x;
1912   0BE9 C9          	ret
1913   0BEA             l_166: 
1914   0BEA             ; 74     }
1915   0BEA             ; 75     for (t = x - 1;; t--) {
1916   0BEA 3D          	dec a
1917   0BEB 32 D4 0F    	ld (__s_findtarget + 0), a
1918   0BEE             l_168: 
1919   0BEE             ; 76         if (array[t] != 0) {
1920   0BEE 2A D4 0F    	ld hl, (__s_findtarget + 0)
1921   0BF1 26 00       	ld h, 0
1922   0BF3 EB          	ex hl, de
1923   0BF4 2A D5 0F    	ld hl, (__a_1_findtarget)
1924   0BF7 19          	add hl, de
1925   0BF8 7E          	ld a, (hl)
1926   0BF9 B7          	or a
1927   0BFA CA 1F 0C    	jp z, l_171
1928   0BFD             ; 77             if (array[t] != array[x]) {
1929   0BFD 2A D7 0F    	ld hl, (__a_2_findtarget)
1930   0C00 26 00       	ld h, 0
1931   0C02 EB          	ex hl, de
1932   0C03 2A D5 0F    	ld hl, (__a_1_findtarget)
1933   0C06 19          	add hl, de
1934   0C07 7E          	ld a, (hl)
1935   0C08 2A D4 0F    	ld hl, (__s_findtarget + 0)
1936   0C0B 26 00       	ld h, 0
1937   0C0D EB          	ex hl, de
1938   0C0E 2A D5 0F    	ld hl, (__a_1_findtarget)
1939   0C11 19          	add hl, de
1940   0C12 BE          	cp (hl)
1941   0C13 CA 1B 0C    	jp z, l_173
1942   0C16             ; 78                 // merge is not possible, take next position
1943   0C16             ; 79                 return t + 1;
1944   0C16 3A D4 0F    	ld a, (__s_findtarget + 0)
1945   0C19 3C          	inc a
1946   0C1A C9          	ret
1947   0C1B             l_173: 
1948   0C1B             ; 80             }
1949   0C1B             ; 81             return t;
1950   0C1B 3A D4 0F    	ld a, (__s_findtarget + 0)
1951   0C1E C9          	ret
1952   0C1F             l_171: 
1953   0C1F             ; 82         } else {
1954   0C1F             ; 83             // we should not slide further, return this one
1955   0C1F             ; 84             if (t == stop) {
1956   0C1F 3A D8 0F    	ld a, (__a_3_findtarget)
1957   0C22 21 D4 0F    	ld hl, __s_findtarget + 0
1958   0C25 BE          	cp (hl)
1959   0C26 C2 2D 0C    	jp nz, l_175
1960   0C29             ; 85                 return t;
1961   0C29 3A D4 0F    	ld a, (__s_findtarget + 0)
1962   0C2C C9          	ret
1963   0C2D             l_175: 
1964   0C2D             l_169: 
1965   0C2D 3A D4 0F    	ld a, (__s_findtarget + 0)
1966   0C30 3D          	dec a
1967   0C31 32 D4 0F    	ld (__s_findtarget + 0), a
1968   0C34 C3 EE 0B    	jp l_168
1969   0C37             l_170: 
1970   0C37             ; 86             }
1971   0C37             ; 87         }
1972   0C37             ; 88     }
1973   0C37             ; 89     // we did not find a
1974   0C37             ; 90     return x;
1975   0C37 3A D7 0F    	ld a, (__a_2_findtarget)
1976   0C3A C9          	ret
1977   0C3B             __snprintf: 
1978   0C3B             ; 21  void __snprintf(char *buffer, size_t buffer_size, const char *format, va_list va) {
1979   0C3B 22 00 10    	ld (__a_4___snprintf), hl
1980   0C3E             ; 22     __printf_out_pointer = buffer;
1981   0C3E 2A FA 0F    	ld hl, (__a_1___snprintf)
1982   0C41 22 CE 0F    	ld (__printf_out_pointer), hl
1983   0C44             ; 23     size_t s = buffer_size;
1984   0C44 2A FC 0F    	ld hl, (__a_2___snprintf)
1985   0C47 22 F8 0F    	ld (__s___snprintf + 0), hl
1986   0C4A             ; 24     if (s > 0)
1987   0C4A 7C          	ld a, h
1988   0C4B B5          	or l
1989   0C4C CA 53 0C    	jp z, l_177
1990   0C4F             ; 25         s--;
1991   0C4F 2B          	dec hl
1992   0C50 22 F8 0F    	ld (__s___snprintf + 0), hl
1993   0C53             l_177: 
1994   0C53             ; 26     __printf_out_end = buffer + s;
1995   0C53 EB          	ex hl, de
1996   0C54 2A FA 0F    	ld hl, (__a_1___snprintf)
1997   0C57 19          	add hl, de
1998   0C58 22 D0 0F    	ld (__printf_out_end), hl
1999   0C5B             ; 27     __printf(format, va);
2000   0C5B 2A FE 0F    	ld hl, (__a_3___snprintf)
2001   0C5E 22 F4 0F    	ld (__a_1___printf), hl
2002   0C61 2A 00 10    	ld hl, (__a_4___snprintf)
2003   0C64 CD 9C 09    	call __printf
2004   0C67             ; 28     if (buffer_size != 0)
2005   0C67 2A FC 0F    	ld hl, (__a_2___snprintf)
2006   0C6A 7C          	ld a, h
2007   0C6B B5          	or l
2008   0C6C C8          	ret z
2009   0C6D             ; 29         *__printf_out_pointer = '\0';
2010   0C6D 2A CE 0F    	ld hl, (__printf_out_pointer)
2011   0C70 36 00       	ld (hl), 0
2012   0C72 C9          	ret
2013   0C73             __printf_out: 
2014   0C73 32 D7 0F    	ld (__a_1___printf_out), a
2015   0C76             ; 30 ;
2016   0C76 2A D2 0F    	ld hl, (__printf_out_total)
2017   0C79 23          	inc hl
2018   0C7A 22 D2 0F    	ld (__printf_out_total), hl
2019   0C7D             ; 31     if (__printf_out_pointer == NULL) {
2020   0C7D 2A CE 0F    	ld hl, (__printf_out_pointer)
2021   0C80 7C          	ld a, h
2022   0C81 B5          	or l
2023   0C82 C2 8E 0C    	jp nz, l_181
2024   0C85             ; 32         putchar((uint8_t)c);
2025   0C85 3A D7 0F    	ld a, (__a_1___printf_out)
2026   0C88 6F          	ld l, a
2027   0C89 26 00       	ld h, 0
2028   0C8B C3 44 0D    	jp putchar
2029   0C8E             l_181: 
2030   0C8E             ; 33         return;
2031   0C8E             ; 34     }
2032   0C8E             ; 35     if (__printf_out_pointer == __printf_out_end)
2033   0C8E 2A D0 0F    	ld hl, (__printf_out_end)
2034   0C91 EB          	ex hl, de
2035   0C92 2A CE 0F    	ld hl, (__printf_out_pointer)
2036   0C95 CD 71 0D    	call __o_xor_16
2037   0C98 C8          	ret z
2038   0C99             ; 36         return;
2039   0C99             ; 37     *__printf_out_pointer = c;
2040   0C99 3A D7 0F    	ld a, (__a_1___printf_out)
2041   0C9C 2A CE 0F    	ld hl, (__printf_out_pointer)
2042   0C9F 77          	ld (hl), a
2043   0CA0             ; 38     __printf_out_pointer++;
2044   0CA0 23          	inc hl
2045   0CA1 22 CE 0F    	ld (__printf_out_pointer), hl
2046   0CA4 C9          	ret
2047   0CA5             uint32tostring: 
2048   0CA5             ; 21  *Uint32ToString(char *outputBuffer, uint32_t value, uint8_t radix) {
2049   0CA5 32 DB 0F    	ld (__a_3_uint32tostring), a
2050   0CA8             ; 22     outputBuffer += UINT32_TO_STRING_SIZE - 1;
2051   0CA8 2A D5 0F    	ld hl, (__a_1_uint32tostring)
2052   0CAB 11 0A 00    	ld de, 10
2053   0CAE 19          	add hl, de
2054   0CAF 22 D5 0F    	ld (__a_1_uint32tostring), hl
2055   0CB2             ; 23     *outputBuffer = 0;
2056   0CB2 36 00       	ld (hl), 0
2057   0CB4             l_185: 
2058   0CB4             ; 24     do {
2059   0CB4             ; 25         value /= radix;
2060   0CB4 2A D9 0F    	ld hl, (((__a_2_uint32tostring) + 2))
2061   0CB7 EB          	ex hl, de
2062   0CB8 2A D7 0F    	ld hl, (__a_2_uint32tostring)
2063   0CBB D5          	push de
2064   0CBC E5          	push hl
2065   0CBD 11 00 00    	ld de, 0
2066   0CC0 2A DB 0F    	ld hl, (__a_3_uint32tostring)
2067   0CC3 62          	ld h, d
2068   0CC4 CD 14 0E    	call __o_div_u32
2069   0CC7 22 D7 0F    	ld (__a_2_uint32tostring), hl
2070   0CCA EB          	ex hl, de
2071   0CCB 22 D9 0F    	ld ((__a_2_uint32tostring) + 2), hl
2072   0CCE             ; 26         --outputBuffer;
2073   0CCE 2A D5 0F    	ld hl, (__a_1_uint32tostring)
2074   0CD1 2B          	dec hl
2075   0CD2 22 D5 0F    	ld (__a_1_uint32tostring), hl
2076   0CD5             ; 27         char c = (char)__div_32_mod + '0';
2077   0CD5 3A 10 0E    	ld a, (__div_32_mod)
2078   0CD8 C6 30       	add 48
2079   0CDA 32 D4 0F    	ld (__s_uint32tostring + 0), a
2080   0CDD             ; 28         if (c > '9') c += 'A' - '0' - 10;
2081   0CDD FE 39       	cp 57
2082   0CDF FA E7 0C    	jp m, l_188
2083   0CE2 C6 07       	add 7
2084   0CE4 32 D4 0F    	ld (__s_uint32tostring + 0), a
2085   0CE7             l_188: 
2086   0CE7             ; 29         *outputBuffer = c;
2087   0CE7 77          	ld (hl), a
2088   0CE8             l_186: 
2089   0CE8             ; 30     } while (value != 0);
2090   0CE8 2A D9 0F    	ld hl, (((__a_2_uint32tostring) + 2))
2091   0CEB EB          	ex hl, de
2092   0CEC 2A D7 0F    	ld hl, (__a_2_uint32tostring)
2093   0CEF 7D          	ld a, l
2094   0CF0 B4          	or h
2095   0CF1 B2          	or d
2096   0CF2 B3          	or e
2097   0CF3 C2 B4 0C    	jp nz, l_185
2098   0CF6             l_187: 
2099   0CF6             ; 31     return outputBuffer;
2100   0CF6 2A D5 0F    	ld hl, (__a_1_uint32tostring)
2101   0CF9 C9          	ret
2102   0CFA             __printf_spaces: 
2103   0CFA             ; 51  void __printf_spaces(unsigned need, unsigned ready, char fill_char) {
2104   0CFA 32 DC 0F    	ld (__a_3___printf_spaces), a
2105   0CFD             ; 52     if (ready >= need)
2106   0CFD 2A D8 0F    	ld hl, (__a_1___printf_spaces)
2107   0D00 EB          	ex hl, de
2108   0D01 2A DA 0F    	ld hl, (__a_2___printf_spaces)
2109   0D04 CD 6A 0D    	call __o_sub_16
2110   0D07 D0          	ret nc
2111   0D08             ; 53         return;
2112   0D08             ; 54     need -= ready;
2113   0D08 2A DA 0F    	ld hl, (__a_2___printf_spaces)
2114   0D0B EB          	ex hl, de
2115   0D0C 2A D8 0F    	ld hl, (__a_1___printf_spaces)
2116   0D0F CD 6A 0D    	call __o_sub_16
2117   0D12 22 D8 0F    	ld (__a_1___printf_spaces), hl
2118   0D15             l_192: 
2119   0D15             ; 55     do {
2120   0D15             ; 56         __printf_out(fill_char);
2121   0D15 3A DC 0F    	ld a, (__a_3___printf_spaces)
2122   0D18 CD 73 0C    	call __printf_out
2123   0D1B             ; 57         need--;
2124   0D1B 2A D8 0F    	ld hl, (__a_1___printf_spaces)
2125   0D1E 2B          	dec hl
2126   0D1F 22 D8 0F    	ld (__a_1___printf_spaces), hl
2127   0D22             l_193: 
2128   0D22             ; 58     } while (need != 0);
2129   0D22 2A D8 0F    	ld hl, (__a_1___printf_spaces)
2130   0D25 7C          	ld a, h
2131   0D26 B5          	or l
2132   0D27 C2 15 0D    	jp nz, l_192
2133   0D2A             l_194: 
2134   0D2A C9          	ret
2135   0D2B             __printf_text: 
2136   0D2B             ; 41  void __printf_text(const char *text) {
2137   0D2B 22 D9 0F    	ld (__a_1___printf_text), hl
2138   0D2E             l_195: 
2139   0D2E             ; 42     for (;;) {
2140   0D2E             ; 43         uint8_t c = *text;
2141   0D2E 2A D9 0F    	ld hl, (__a_1___printf_text)
2142   0D31 7E          	ld a, (hl)
2143   0D32 32 D8 0F    	ld (__s___printf_text + 0), a
2144   0D35             ; 44         if (c == '\0')
2145   0D35 B7          	or a
2146   0D36 C8          	ret z
2147   0D37             ; 45             break;
2148   0D37             ; 46         __printf_out(c);
2149   0D37 CD 73 0C    	call __printf_out
2150   0D3A             ; 47         text++;
2151   0D3A 2A D9 0F    	ld hl, (__a_1___printf_text)
2152   0D3D 23          	inc hl
2153   0D3E 22 D9 0F    	ld (__a_1___printf_text), hl
2154   0D41             l_196: 
2155   0D41 C3 2E 0D    	jp l_195
2156   0D44             putchar: 
2157   0D44             ; 45  putchar(int c) {
2158   0D44 22 D5 0F    	ld (__a_1_putchar), hl
2159   0D47             ; 46     if (c == 0x0A)
2160   0D47 11 0A 00    	ld de, 10
2161   0D4A CD 71 0D    	call __o_xor_16
2162   0D4D C2 55 0D    	jp nz, l_200
2163   0D50             ; 47         cpmBiosConOut(0x0D);
2164   0D50 3E 0D       	ld a, 13
2165   0D52 CD 5F 0D    	call cpmbiosconout
2166   0D55             l_200: 
2167   0D55             ; 48     cpmBiosConOut(c);
2168   0D55 3A D5 0F    	ld a, (__a_1_putchar)
2169   0D58 CD 5F 0D    	call cpmbiosconout
2170   0D5B             ; 49     return 0;
2171   0D5B 21 00 00    	ld hl, 0
2172   0D5E C9          	ret
2173   0D5F             cpmbiosconout: 
2174   0D5F             ; 36  void __fastcall cpmBiosConOut(uint8_t c) {
2175   0D5F 32 D4 0F    	ld (__a_1_cpmbiosconout), a
2176   0D62             
2177   0D62 4F                  ld c, a
2178   0D63 2A 01 00            ld hl, (1)
2179   0D66 2E 0C               ld l, 0Ch
2180   0D68 E9                  jp hl
2181   0D69                 
2182   0D69 C9          	ret
2183   0D6A             __o_sub_16: 
2184   0D6A 7D              ld a, l
2185   0D6B 93              sub e
2186   0D6C 6F              ld l, a
2187   0D6D 7C              ld a, h
2188   0D6E 9A              sbc d
2189   0D6F 67              ld h, a
2190   0D70 C9              ret
2191   0D71             ; Input: hl - value 1, de - value 2
2192   0D71             ; Output: hl - result
2193   0D71             
2194   0D71             __o_xor_16: 
2195   0D71 7C              ld a, h
2196   0D72 AA              xor d
2197   0D73 67              ld h, a
2198   0D74 7D              ld a, l
2199   0D75 AB              xor e
2200   0D76 6F              ld l, a
2201   0D77 B4              or h     ; Flag Z used for compare
2202   0D78 C9              ret
2203   0D79 00 00       __div_16_mod dw 0
2204   0D7B             
2205   0D7B             __o_div_u16: 
2206   0D7B C5              push bc
2207   0D7C EB              ex hl, de
2208   0D7D CD 87 0D        call __o_div_u16__l0
2209   0D80 EB              ex hl, de
2210   0D81 22 79 0D        ld (__div_16_mod), hl
2211   0D84 EB              ex hl, de
2212   0D85 C1              pop bc
2213   0D86 C9              ret
2214   0D87             
2215   0D87             __o_div_u16__l0: 
2216   0D87             __o_div_u16__l: 
2217   0D87 7C              ld a, h
2218   0D88 B5              or l
2219   0D89 C8              ret z
2220   0D8A 01 00 00        ld bc, 0
2221   0D8D C5              push bc
2222   0D8E             __o_div_u16__l1: 
2223   0D8E 7B              ld a, e
2224   0D8F 95              sub l
2225   0D90 7A              ld a, d
2226   0D91 9C              sbc h
2227   0D92 DA 9A 0D        jp c, __o_div_u16__l2
2228   0D95 E5              push hl
2229   0D96 29              add hl, hl
2230   0D97 D2 8E 0D        jp nc, __o_div_u16__l1
2231   0D9A             __o_div_u16__l2: 
2232   0D9A 21 00 00        ld hl, 0
2233   0D9D             __o_div_u16__l3: 
2234   0D9D C1              pop bc
2235   0D9E 78              ld a, b
2236   0D9F B1              or c
2237   0DA0 C8              ret z
2238   0DA1 29              add hl, hl
2239   0DA2 D5              push de
2240   0DA3 7B              ld a, e
2241   0DA4 91              sub c
2242   0DA5 5F              ld e, a
2243   0DA6 7A              ld a, d
2244   0DA7 98              sbc b
2245   0DA8 57              ld d, a
2246   0DA9 DA B1 0D        jp c, __o_div_u16__l4
2247   0DAC 23              inc hl
2248   0DAD C1              pop bc
2249   0DAE C3 9D 0D        jp __o_div_u16__l3
2250   0DB1             __o_div_u16__l4: 
2251   0DB1 D1              pop de
2252   0DB2 C3 9D 0D        jp __o_div_u16__l3
2253   0DB5             __o_mod_u16: 
2254   0DB5 C5              push bc
2255   0DB6 EB              ex hl, de
2256   0DB7 CD 87 0D        call __o_div_u16__l0
2257   0DBA EB              ex hl, de
2258   0DBB C1              pop bc
2259   0DBC C9              ret
2260   0DBD             __o_shl_16: 
2261   0DBD 1C              inc e
2262   0DBE             __o_shl_16__l1: 
2263   0DBE 1D              dec e
2264   0DBF C8              ret z
2265   0DC0 29              add hl, hl
2266   0DC1 C3 BE 0D        jp __o_shl_16__l1
2267   0DC4             __o_shr_u16: 
2268   0DC4 1C              inc e
2269   0DC5             __o_shr_u16__l1: 
2270   0DC5 1D              dec e
2271   0DC6 C8              ret z
2272   0DC7 7C              ld a, h
2273   0DC8 B7              or a  ; cf = 0
2274   0DC9 1F              rra
2275   0DCA 67              ld h, a
2276   0DCB 7D              ld a, l
2277   0DCC 1F              rra
2278   0DCD 6F              ld l, a
2279   0DCE C3 C5 0D        jp __o_shr_u16__l1
2280   0DD1             ; Input: de:hl - value 1, stack - 32 bit value 2
2281   0DD1             ; Output: de:hl - result
2282   0DD1             
2283   0DD1             __o_add_32: 
2284   0DD1 44 4D           ld bc, hl ; bc = v1l
2285   0DD3 E1              pop hl ; hl = ret, stack = v2l
2286   0DD4 E3              ex (sp), hl ; hl = v2l, stack = ret
2287   0DD5 79              ld a, c
2288   0DD6 85              add l
2289   0DD7 4F              ld c, a
2290   0DD8 78              ld a, b
2291   0DD9 8C              adc h
2292   0DDA 47              ld b, a ; bc - result
2293   0DDB E1              pop hl ; hl = ret, stack = v2h
2294   0DDC E3              ex (sp), hl ; hl = v2h, stack = ret
2295   0DDD 7B              ld a, e
2296   0DDE 8D              adc l
2297   0DDF 5F              ld e, a
2298   0DE0 7A              ld a, d
2299   0DE1 8C              adc h
2300   0DE2 57              ld d, a ; de - result
2301   0DE3 60 69           ld hl, bc
2302   0DE5 C9              ret
2303   0DE6             ; Input: de:hl - value 1, stack - 32 bit value 2
2304   0DE6             ; Output: de:hl - result
2305   0DE6             
2306   0DE6             __o_sub_32: 
2307   0DE6 44 4D           ld bc, hl ; bc = v1l
2308   0DE8 E1              pop hl ; hl = ret, stack = v2l
2309   0DE9 E3              ex (sp), hl ; hl = v2l, stack = ret
2310   0DEA 7D              ld a, l
2311   0DEB 91              sub c
2312   0DEC 4F              ld c, a
2313   0DED 7C              ld a, h
2314   0DEE 98              sbc b
2315   0DEF 47              ld b, a ; bc - result
2316   0DF0 E1              pop hl ; hl = ret, stack = v2h
2317   0DF1 E3              ex (sp), hl ; hl = v2h, stack = ret
2318   0DF2 7D              ld a, l
2319   0DF3 9B              sbc e
2320   0DF4 5F              ld e, a
2321   0DF5 7C              ld a, h
2322   0DF6 9A              sbc d
2323   0DF7 57              ld d, a ; de - result
2324   0DF8 60 69           ld hl, bc
2325   0DFA C9              ret
2326   0DFB             __o_i16_to_i32: 
2327   0DFB 11 00 00        ld de, 0
2328   0DFE 7C              ld a, h
2329   0DFF E6 80           and 80h
2330   0E01 C8              ret z
2331   0E02 1B              dec de
2332   0E03 C9              ret; Input: hl - address
2333   0E04             ; Output: de:hl - result
2334   0E04             
2335   0E04             __o_load_32: 
2336   0E04 4E              ld c, (hl)
2337   0E05 23              inc hl
2338   0E06 46              ld b, (hl)
2339   0E07 23              inc hl
2340   0E08 5E              ld e, (hl)
2341   0E09 23              inc hl
2342   0E0A 56              ld d, (hl)
2343   0E0B 60 69           ld hl, bc
2344   0E0D C9              ret
2345   0E0E 00 00       __o_div_u32__result dw 0
2346   0E10 00 00 00 00 __div_32_mod dd 0
2347   0E14             
2348   0E14             __o_div_u32: 
2349   0E14 44 4D           ld bc, hl                    ; __div_32_mod = a
2350   0E16 E1              pop hl
2351   0E17 E3              ex (sp), hl
2352   0E18 22 10 0E        ld (__div_32_mod+0), hl
2353   0E1B E1              pop hl
2354   0E1C E3              ex (sp), hl
2355   0E1D 22 12 0E        ld (__div_32_mod+2), hl
2356   0E20 21 A0 0E        ld hl, __o_div_u32__ret
2357   0E23             __o_div_u32__com: 
2358   0E23 22 5B 0E        ld (__o_div_u32__ra), hl
2359   0E26 60 69           ld hl, bc
2360   0E28 7C              ld a, h                      ; if (b == 0) return;
2361   0E29 B5              or l
2362   0E2A B2              or d
2363   0E2B B3              or e
2364   0E2C C8              ret z
2365   0E2D 0E 01           ld c, 1                      ; c = 1;
2366   0E2F             __o_div_u32__l1:                  ; do
2367   0E2F 3A 10 0E        ld a, (__div_32_mod+0)       ; if (a < b) break;
2368   0E32 95              sub l
2369   0E33 3A 11 0E        ld a, (__div_32_mod+1)
2370   0E36 9C              sbc h
2371   0E37 3A 12 0E        ld a, (__div_32_mod+2)
2372   0E3A 9B              sbc e
2373   0E3B 3A 13 0E        ld a, (__div_32_mod+3)
2374   0E3E 9A              sbc d
2375   0E3F DA 4B 0E        jp c, __o_div_u32__l2
2376   0E42 0C              inc c
2377   0E43 E5              push hl                      ; push(b);
2378   0E44 D5              push de
2379   0E45 CD A4 0E        call __o_div_u32__shl_dehl   ; b <<= 1;
2380   0E48 D2 2F 0E        jp nc, __o_div_u32__l1       ; } while(flag_nc);
2381   0E4B             __o_div_u32__l2: 
2382   0E4B 79              ld a, c
2383   0E4C 32 58 0E        ld (__o_div_u32__lc), a
2384   0E4F 21 00 00        ld hl, 0                     ; result = 0
2385   0E52 22 0E 0E        ld (__o_div_u32__result), hl
2386   0E55 54 5D           ld de, hl
2387   0E57             __o_div_u32__l4:                  ; while(--c != 0) {
2388   0E57             __o_div_u32__lc=$+1
2389   0E57 3E 00           ld a, 0
2390   0E59 3D              dec a
2391   0E5A             __o_div_u32__ra=$+1
2392   0E5A CA A0 0E        jp z, __o_div_u32__ret
2393   0E5D 32 58 0E        ld (__o_div_u32__lc), a
2394   0E60             
2395   0E60 2A 0E 0E        ld hl, (__o_div_u32__result) ; result <<= 1
2396   0E63 CD A4 0E        call __o_div_u32__shl_dehl
2397   0E66 22 0E 0E        ld (__o_div_u32__result), hl
2398   0E69             
2399   0E69 C1              pop bc                       ; pop(x)
2400   0E6A E1              pop hl
2401   0E6B             
2402   0E6B 3A 10 0E        ld a, (__div_32_mod+0)       ; if (x < __div_32_mod) continue;
2403   0E6E 95              sub l
2404   0E6F 3A 11 0E        ld a, (__div_32_mod+1)
2405   0E72 9C              sbc h
2406   0E73 3A 12 0E        ld a, (__div_32_mod+2)
2407   0E76 99              sbc c
2408   0E77 3A 13 0E        ld a, (__div_32_mod+3)
2409   0E7A 98              sbc b
2410   0E7B DA 57 0E        jp c, __o_div_u32__l4
2411   0E7E                 
2412   0E7E 32 13 0E        ld (__div_32_mod+3), a       ; __div_32_mod -= x
2413   0E81 3A 10 0E        ld a, (__div_32_mod+0)
2414   0E84 95              sub l
2415   0E85 32 10 0E        ld (__div_32_mod+0), a
2416   0E88 3A 11 0E        ld a, (__div_32_mod+1)
2417   0E8B 9C              sbc h
2418   0E8C 32 11 0E        ld (__div_32_mod+1), a
2419   0E8F 3A 12 0E        ld a, (__div_32_mod+2)
2420   0E92 99              sbc c
2421   0E93 32 12 0E        ld (__div_32_mod+2), a
2422   0E96             
2423   0E96 2A 0E 0E        ld hl, (__o_div_u32__result) ; result++;
2424   0E99 23              inc hl
2425   0E9A 22 0E 0E        ld (__o_div_u32__result), hl
2426   0E9D C3 57 0E        jp __o_div_u32__l4           ; }
2427   0EA0             
2428   0EA0             __o_div_u32__ret:                 ; return result
2429   0EA0 2A 0E 0E        ld hl, (__o_div_u32__result)
2430   0EA3 C9              ret
2431   0EA4             
2432   0EA4             __o_div_u32__shl_dehl: 
2433   0EA4 EB              ex hl, de
2434   0EA5 29              add hl, hl
2435   0EA6 EB              ex hl, de
2436   0EA7 F5              push af
2437   0EA8 29              add hl, hl
2438   0EA9 D2 AD 0E        jp nc, __o_div_u32__l5
2439   0EAC 13              inc de
2440   0EAD             __o_div_u32__l5: 
2441   0EAD F1              pop af
2442   0EAE C9              ret
2443   0EAF                 
2444   0EAF             ; Input: de:hl - value 1, stack - 32 bit value 2
2445   0EAF             ; Output: de:hl - result
2446   0EAF             
2447   0EAF             __o_shl_32: 
2448   0EAF 7D              ld a, l
2449   0EB0 E1              pop hl ; hl = ret, stack = v2l
2450   0EB1 E3              ex (sp), hl ; hl = v2l, stack = ret
2451   0EB2 44 4D           ld bc, hl
2452   0EB4 E1              pop hl ; hl = ret, stack = v2l
2453   0EB5 E3              ex (sp), hl ; hl = v2h, stack = ret
2454   0EB6 EB              ex hl, de
2455   0EB7 60 69           ld hl, bc
2456   0EB9 E6 1F           and 31
2457   0EBB             __o_shl_32_1: 
2458   0EBB C8              ret z
2459   0EBC EB              ex hl, de
2460   0EBD 29              add hl, hl
2461   0EBE EB              ex hl, de
2462   0EBF 29              add hl, hl
2463   0EC0 D2 C4 0E        jp nc, __o_shl_32_2
2464   0EC3 13              inc de
2465   0EC4             __o_shl_32_2: 
2466   0EC4 3D              dec a
2467   0EC5 C3 BB 0E        jp __o_shl_32_1
2468   0EC8             __o_minus_32: 
2469   0EC8 AF              xor a
2470   0EC9 95              sub l
2471   0ECA 6F              ld l, a
2472   0ECB 3E 00           ld a, 0
2473   0ECD 9C              sbc h
2474   0ECE 67              ld h, a
2475   0ECF 3E 00           ld a, 0
2476   0ED1 9B              sbc e
2477   0ED2 5F              ld e, a
2478   0ED3 3E 00           ld a, 0
2479   0ED5 9A              sbc d
2480   0ED6 57              ld d, a
2481   0ED7 C9              ret
2482   0ED8             __c_5: 
2483   0ED8 00            db 0
2484   0ED9             __c_2: 
2485   0ED9 0A0A0A0A00    db 10, 10, 10, 10, 0
2486   0EDE             __c_12: 
2487   0EDE               db 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 119, 44, 97, 44, 115
2487   0EDE 0A20202020202020202020772C612C73
2488   0EEE               db 44, 100, 32, 111, 114, 32, 114, 44, 113, 32, 32, 32, 32, 32, 32, 32
2488   0EEE 2C64206F7220722C7120202020202020
2489   0EFE 0A 00         db 10, 0
2490   0F00             __c_0: 
2491   0F00 1B 5B 48 00   db 27, 91, 72, 0
2492   0F04             __c_7: 
2493   0F04               db 27, 91, 72, 27, 91, 50, 74, 0
2493   0F04 1B5B481B5B324A00
2494   0F0C             __c_18: 
2495   0F0C               db 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 71, 65, 77, 69
2495   0F0C 20202020202020202020202047414D45
2496   0F1C               db 32, 79, 86, 69, 82, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 10
2496   0F1C 204F564552202020202020202020200A
2497   0F2C 00            db 0
2498   0F2D             __c_19: 
2499   0F2D               db 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 81, 85, 73, 84
2499   0F2D 20202020202020202020202051554954
2500   0F3D               db 63, 32, 40, 121, 47, 110, 41, 32, 32, 32, 32, 32, 32, 32, 32, 32
2500   0F3D 3F2028792F6E29202020202020202020
2501   0F4D 0A 00         db 10, 0
2502   0F4F             __c_20: 
2503   0F4F               db 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 82, 69, 83, 84, 65, 82
2503   0F4F 20202020202020202020524553544152
2504   0F5F               db 84, 63, 32, 40, 121, 47, 110, 41, 32, 32, 32, 32, 32, 32, 32, 10
2504   0F5F 543F2028792F6E29202020202020200A
2505   0F6F 00            db 0
2506   0F70             __c_3: 
2507   0F70 25 75 00      db 37, 117, 0
2508   0F73             __c_10: 
2509   0F73 2B 0A 00      db 43, 10, 0
2510   0F76             __c_9: 
2511   0F76               db 43, 45, 45, 45, 45, 45, 45, 45, 0
2511   0F76 2B2D2D2D2D2D2D2D00
2512   0F7F             __c_8: 
2513   0F7F               db 50, 48, 52, 56, 46, 99, 32, 37, 49, 55, 100, 32, 112, 116, 115, 10
2513   0F7F 323034382E632025313764207074730A
2514   0F8F 0A 00         db 10, 0
2515   0F91             __c_1: 
2516   0F91               db 50, 48, 52, 56, 46, 99, 32, 37, 50, 51, 100, 32, 112, 116, 115, 0
2516   0F91 323034382E6320253233642070747300
2517   0FA1             __c_11: 
2518   0FA1 7C 0A 00      db 124, 10, 0
2519   0FA4             __c_6: 
2520   0FA4               db 124, 32, 32, 32, 32, 32, 32, 32, 0
2520   0FA4 7C2020202020202000
2521   0FAD             __c_4: 
2522   0FAD               db 124, 37, 42, 115, 37, 115, 37, 42, 115, 0
2522   0FAD 7C252A732573252A7300
2523   0FB7             score: 
2524   0FB7 00 00 00 00 	dd 0
2525   0FBB             __s_addrandom_initialized: 
2526   0FBB 00          	db 0
2527   0FBC             __rand_seed: 
2528   0FBC 01 00       	dw 1
2529   0FBE             __bss: 
2530   0FBE             board: 
2531   0FBE 00          	ds 16
2532   0FCE             __printf_out_pointer: 
2533   0FCE 00          	ds 2
2534   0FD0             __printf_out_end: 
2535   0FD0 00          	ds 2
2536   0FD2             __printf_out_total: 
2537   0FD2 00          	ds 2
2538   0FD4             __static_stack: 
2539   0FD4 00          	ds 70
2540   101A             __end: 
2541   101A             __s_drawboard equ __static_stack + 48
2542   101A             __s_strlen equ __static_stack + 0
2543   101A             __a_1_strlen equ __s_strlen + 0
2544   101A             __s_preparescreen equ __static_stack + 59
2545   101A             __s_findtarget equ __static_stack + 0
2546   101A             __a_1_findtarget equ __s_findtarget + 1
2547   101A             __a_2_findtarget equ __s_findtarget + 3
2548   101A             __a_3_findtarget equ __s_findtarget + 4
2549   101A             __s_slidearray equ __static_stack + 5
2550   101A             __a_1_slidearray equ __s_slidearray + 4
2551   101A             __s_rotateboard equ __static_stack + 0
2552   101A             __s_moveup equ __static_stack + 11
2553   101A             __s_moveleft equ __static_stack + 13
2554   101A             __s_movedown equ __static_stack + 13
2555   101A             __s_moveright equ __static_stack + 13
2556   101A             __s_findpairdown equ __static_stack + 0
2557   101A             __s_countempty equ __static_stack + 0
2558   101A             __s_gameended equ __static_stack + 4
2559   101A             __s_addrandom equ __static_stack + 0
2560   101A             __s_initboard equ __static_stack + 62
2561   101A             __s_test equ __static_stack + 0
2562   101A             __s_main equ __static_stack + 64
2563   101A             __a_1_main equ __s_main + 2
2564   101A             __a_2_main equ __s_main + 4
2565   101A             __s_sleep equ __static_stack + 2
2566   101A             __a_1_sleep equ __s_sleep + 0
2567   101A             __s___printf equ __static_stack + 9
2568   101A             __a_1___printf equ __s___printf + 23
2569   101A             __a_2___printf equ __s___printf + 25
2570   101A             __s___snprintf equ __static_stack + 36
2571   101A             __a_1___snprintf equ __s___snprintf + 2
2572   101A             __a_2___snprintf equ __s___snprintf + 4
2573   101A             __a_3___snprintf equ __s___snprintf + 6
2574   101A             __a_4___snprintf equ __s___snprintf + 8
2575   101A             __s_delay equ __static_stack + 0
2576   101A             __a_1_delay equ __s_delay + 0
2577   101A             __s___printf_out equ __static_stack + 3
2578   101A             __a_1___printf_out equ __s___printf_out + 0
2579   101A             __s_putchar equ __static_stack + 1
2580   101A             __a_1_putchar equ __s_putchar + 0
2581   101A             __s___printf_text equ __static_stack + 4
2582   101A             __a_1___printf_text equ __s___printf_text + 1
2583   101A             __s___printf_spaces equ __static_stack + 4
2584   101A             __a_1___printf_spaces equ __s___printf_spaces + 0
2585   101A             __a_2___printf_spaces equ __s___printf_spaces + 2
2586   101A             __a_3___printf_spaces equ __s___printf_spaces + 4
2587   101A             __s_uint32tostring equ __static_stack + 0
2588   101A             __a_1_uint32tostring equ __s_uint32tostring + 1
2589   101A             __a_2_uint32tostring equ __s_uint32tostring + 3
2590   101A             __a_3_uint32tostring equ __s_uint32tostring + 7
2591   101A             __s_cpmbiosconout equ __static_stack + 0
2592   101A             __a_1_cpmbiosconout equ __s_cpmbiosconout + 0
2593   101A                 savebin "game2048.com", __begin, __bss - __begin
2594   101A             
